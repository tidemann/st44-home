<div class="qr-display-container">
  <!-- Loading State -->
  @if (loading()) {
    <div class="loading-state" role="status" aria-live="polite">
      <div class="spinner" aria-hidden="true"></div>
      <p i18n="@@qrCodeDisplay.generating">Genererer QR-kode...</p>
    </div>
  }

  <!-- Error State -->
  @if (error() && !loading()) {
    <div class="error-state" role="alert" aria-live="assertive">
      <div class="error-icon" aria-hidden="true">âš ï¸</div>
      <p>{{ error() }}</p>
      <button class="btn btn-secondary" (click)="loadQrToken()" i18n="@@qrCodeDisplay.tryAgain">
        Prov igjen
      </button>
    </div>
  }

  <!-- QR Code Display -->
  @if (qrToken() && !loading() && !error()) {
    <div class="qr-content">
      @if (childName()) {
        <div class="qr-header">
          <p class="child-name" i18n="@@qrCodeDisplay.forChild">for {{ childName() }}</p>
        </div>
      }

      <div class="qr-canvas-wrapper">
        <canvas #qrCanvas aria-label="QR-kode for barneinnlogging"></canvas>
      </div>

      @if (expiresAt()) {
        <p class="expiration-text">{{ getExpirationText() }}</p>
      }

      <div class="qr-instructions">
        <p i18n="@@qrCodeDisplay.instructions">
          Skann denne QR-koden med Diddit-appen for a logge inn raskt.
        </p>
      </div>

      <div class="qr-actions">
        <button
          class="btn btn-secondary"
          (click)="download()"
          aria-label="Last ned QR-kode som bilde"
          i18n="@@qrCodeDisplay.download"
        >
          ğŸ“¥ Last ned
        </button>
        <button
          class="btn btn-secondary"
          (click)="print()"
          aria-label="Skriv ut QR-kode"
          i18n="@@qrCodeDisplay.print"
        >
          ğŸ–¨ï¸ Skriv ut
        </button>
        <button
          class="btn btn-secondary"
          (click)="regenerate()"
          aria-label="Generer QR-kode pa nytt"
          [disabled]="loading()"
          i18n="@@qrCodeDisplay.regenerate"
        >
          ğŸ”„ Generer pa nytt
        </button>
      </div>
    </div>
  }
</div>
