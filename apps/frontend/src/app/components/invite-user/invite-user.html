<div class="invite-user">
  <h2>Invite Someone</h2>

  <form [formGroup]="inviteForm" (ngSubmit)="onSubmit()" class="invite-form">
    <!-- Email Input -->
    <div class="form-group">
      <label for="email" class="required">Email Address</label>
      <input
        type="email"
        id="email"
        formControlName="email"
        class="form-control"
        placeholder="user@example.com"
        [attr.aria-invalid]="inviteForm.get('email')?.invalid && inviteForm.get('email')?.touched"
        [attr.aria-describedby]="getEmailError() ? 'email-error' : null"
        required
      />
      @if (getEmailError()) {
        <span id="email-error" class="error-message" role="alert">{{ getEmailError() }}</span>
      }
    </div>

    <!-- Role Selector -->
    <div class="form-group">
      <label for="role">Role</label>
      <select id="role" formControlName="role" class="form-control">
        <option value="parent">Parent</option>
        <option value="admin">Admin</option>
      </select>
      <small class="form-hint">
        Parents can manage children and tasks. Admins can also invite users and edit household
        settings.
      </small>
    </div>

    <!-- Error Message -->
    @if (errorMessage()) {
      <div class="alert alert-error" role="alert">
        {{ errorMessage() }}
      </div>
    }

    <!-- Success Message -->
    @if (successMessage()) {
      <div class="alert alert-success" role="alert">
        {{ successMessage() }}
      </div>
    }

    <!-- Invitation Link -->
    @if (invitationLink()) {
      <div class="invitation-link-section">
        <label for="invitation-link">Invitation Link</label>
        <div class="link-container">
          <input
            type="text"
            id="invitation-link"
            readonly
            [value]="invitationLink()"
            class="form-control link-input"
            aria-label="Invitation link"
          />
          <button
            type="button"
            (click)="copyInvitationLink()"
            class="btn btn-secondary"
            aria-label="Copy invitation link to clipboard"
          >
            Copy Link
          </button>
        </div>
        <small class="form-hint">
          Share this link with the person you invited. It expires in 7 days.
        </small>
      </div>
    }

    <!-- Submit Button -->
    <div class="form-actions">
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="isSending()"
        [attr.aria-busy]="isSending()"
      >
        @if (isSending()) {
          <span>Sending Invitation...</span>
        } @else {
          <span>Send Invitation</span>
        }
      </button>
    </div>
  </form>
</div>
