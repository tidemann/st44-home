<div class="invite-user">
  <h2 i18n="@@inviteUser.title">Inviter noen</h2>

  <form [formGroup]="inviteForm" (ngSubmit)="onSubmit()" class="invite-form">
    <!-- Email Input -->
    <div class="form-group">
      <label for="email" class="required" i18n="@@inviteUser.emailLabel">E-postadresse</label>
      <input
        type="email"
        id="email"
        formControlName="email"
        class="form-control"
        i18n-placeholder="@@inviteUser.emailPlaceholder"
        placeholder="bruker@eksempel.no"
        [attr.aria-invalid]="inviteForm.get('email')?.invalid && inviteForm.get('email')?.touched"
        [attr.aria-describedby]="getEmailError() ? 'email-error' : null"
        required
      />
      @if (getEmailError()) {
        <span id="email-error" class="error-message" role="alert">{{ getEmailError() }}</span>
      }
    </div>

    <!-- Role Selector -->
    <div class="form-group">
      <label for="role" i18n="@@inviteUser.roleLabel">Rolle</label>
      <select id="role" formControlName="role" class="form-control">
        <option value="parent" i18n="@@inviteUser.roleParent">Forelder</option>
        <option value="admin" i18n="@@inviteUser.roleAdmin">Administrator</option>
      </select>
      <small class="form-hint" i18n="@@inviteUser.roleHint">
        Foreldre kan administrere barn og oppgaver. Administratorer kan også invitere brukere og
        redigere husstandsinnstillinger.
      </small>
    </div>

    <!-- Error Message -->
    @if (errorMessage()) {
      <div class="alert alert-error" role="alert">
        {{ errorMessage() }}
      </div>
    }

    <!-- Success Message -->
    @if (successMessage()) {
      <div class="alert alert-success" role="alert">
        {{ successMessage() }}
      </div>
    }

    <!-- Invitation Link -->
    @if (invitationLink()) {
      <div class="invitation-link-section">
        <label for="invitation-link" i18n="@@inviteUser.invitationLinkLabel"
          >Invitasjonslenke</label
        >
        <div class="link-container">
          <input
            type="text"
            id="invitation-link"
            readonly
            [value]="invitationLink()"
            class="form-control link-input"
            i18n-aria-label="@@inviteUser.invitationLinkAria"
            aria-label="Invitasjonslenke"
          />
          <button
            type="button"
            (click)="copyInvitationLink()"
            class="btn btn-secondary"
            i18n-aria-label="@@inviteUser.copyLinkAria"
            aria-label="Kopier invitasjonslenke til utklippstavle"
            i18n="@@inviteUser.copyLink"
          >
            Kopier lenke
          </button>
        </div>
        <small class="form-hint" i18n="@@inviteUser.invitationLinkHint">
          Del denne lenken med personen du inviterte. Den utløper om 7 dager.
        </small>
      </div>
    }

    <!-- Submit Button -->
    <div class="form-actions">
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="isSending()"
        [attr.aria-busy]="isSending()"
      >
        @if (isSending()) {
          <span i18n="@@inviteUser.sendingInvitation">Sender invitasjon...</span>
        } @else {
          <span i18n="@@inviteUser.sendInvitation">Send invitasjon</span>
        }
      </button>
    </div>
  </form>
</div>
