<div class="qr-scanner-container">
  <!-- Loading State -->
  @if (loading()) {
    <div class="loading-state" role="status" aria-live="polite">
      <div class="spinner" aria-hidden="true"></div>
      <p i18n="@@qrCodeScanner.initializing">Initialiserer kamera...</p>
    </div>
  }

  <!-- Camera Permission Denied -->
  @if (cameraPermissionDenied() && !loading()) {
    <div class="permission-denied" role="alert" aria-live="assertive">
      <div class="icon" aria-hidden="true">üì∑</div>
      <h3 i18n="@@qrCodeScanner.cameraAccessRequired">Kameratilgang pakrevd</h3>
      <p i18n="@@qrCodeScanner.allowCameraMessage">
        Vennligst tillat kameratilgang for a skanne QR-koder.
      </p>
      <div class="actions">
        <button
          class="btn btn-primary"
          (click)="requestPermission()"
          i18n="@@qrCodeScanner.allowCameraButton"
        >
          Tillat kameratilgang
        </button>
        <button class="btn btn-secondary" (click)="cancel()" i18n="@@qrCodeScanner.cancelButton">
          Avbryt
        </button>
      </div>
    </div>
  }

  <!-- No Camera Available -->
  @if (noCameraAvailable() && !loading()) {
    <div class="no-camera" role="alert" aria-live="assertive">
      <div class="icon" aria-hidden="true">üìµ</div>
      <h3 i18n="@@qrCodeScanner.noCameraFound">Ingen kamera funnet</h3>
      <p i18n="@@qrCodeScanner.noCameraMessage">
        Enheten din har ikke et kamera eller det er ikke tilgjengelig.
      </p>
      <p class="help-text" i18n="@@qrCodeScanner.alternativeLogin">
        Du kan bruke passord/PIN-innlogging i stedet, eller prove a skanne fra en annen enhet.
      </p>
      <button class="btn btn-secondary" (click)="cancel()" i18n="@@qrCodeScanner.backToLogin">
        Tilbake til innlogging
      </button>
    </div>
  }

  <!-- Error State -->
  @if (error() && !loading() && !cameraPermissionDenied() && !noCameraAvailable()) {
    <div class="error-state" role="alert" aria-live="assertive">
      <div class="error-icon" aria-hidden="true">‚ö†Ô∏è</div>
      <p>{{ error() }}</p>
      <div class="actions">
        <button class="btn btn-primary" (click)="retry()" i18n="@@qrCodeScanner.tryAgainButton">
          Prov igjen
        </button>
        <button class="btn btn-secondary" (click)="cancel()" i18n="@@qrCodeScanner.cancelButton2">
          Avbryt
        </button>
      </div>
    </div>
  }

  <!-- Scanner Active -->
  @if (scanning() && !error()) {
    <div class="scanner-active">
      <div class="video-wrapper">
        <video #videoElement autoplay playsinline></video>
        <div class="scan-overlay">
          <div class="scan-frame"></div>
        </div>
      </div>

      <div class="scanner-instructions">
        <p i18n="@@qrCodeScanner.positionQrCode">Plasser QR-koden innenfor rammen</p>
      </div>

      <button class="btn btn-cancel" (click)="cancel()" i18n="@@qrCodeScanner.cancelScanning">
        Avbryt skanning
      </button>
    </div>
  }
</div>
