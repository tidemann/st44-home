<div class="invitations-sent-list">
  <div class="header">
    <h3 i18n="@@invitationsSent.title">Sendte invitasjoner</h3>
    <div class="header-actions">
      @if (hasOldInvitations()) {
        <button
          type="button"
          class="btn btn-warning btn-sm"
          (click)="cleanupInvitations()"
          [disabled]="isLoading()"
          i18n-aria-label="@@invitationsSent.cleanupAria"
          aria-label="Fjern kansellerte og utløpte invitasjoner"
          i18n="@@invitationsSent.cleanup"
        >
          Rydd opp gamle
        </button>
      }
      <button
        type="button"
        class="btn btn-secondary btn-sm"
        (click)="loadInvitations()"
        [disabled]="isLoading()"
        i18n-aria-label="@@invitationsSent.refreshAria"
        aria-label="Oppdater invitasjonsliste"
        i18n="@@invitationsSent.refresh"
      >
        Oppdater
      </button>
    </div>
  </div>

  <!-- Success message -->
  @if (successMessage()) {
    <div class="alert alert-success" role="alert">
      {{ successMessage() }}
    </div>
  }

  <!-- Error message -->
  @if (errorMessage()) {
    <div class="alert alert-error" role="alert">
      {{ errorMessage() }}
    </div>
  }

  <!-- Loading state -->
  @if (isLoading()) {
    <div class="loading" i18n="@@invitationsSent.loading">Laster invitasjoner...</div>
  }

  <!-- Empty state -->
  @if (!isLoading() && invitations().length === 0) {
    <div class="empty-state">
      <p i18n="@@invitationsSent.noInvitations">Ingen invitasjoner sendt ennå.</p>
      <p i18n="@@invitationsSent.emptyStateHint">
        Bruk skjemaet "Inviter noen" ovenfor for å invitere noen til husstanden din.
      </p>
    </div>
  }

  <!-- Invitations table -->
  @if (!isLoading() && invitations().length > 0) {
    <div
      class="invitations-table"
      role="table"
      i18n-aria-label="@@invitationsSent.tableAria"
      aria-label="Sendte invitasjoner"
    >
      <div class="table-header" role="row">
        <div class="cell email" role="columnheader" i18n="@@invitationsSent.columnEmail">
          E-post
        </div>
        <div class="cell role" role="columnheader" i18n="@@invitationsSent.columnRole">Rolle</div>
        <div class="cell status" role="columnheader" i18n="@@invitationsSent.columnStatus">
          Status
        </div>
        <div class="cell date" role="columnheader" i18n="@@invitationsSent.columnSent">Sendt</div>
        <div class="cell expires" role="columnheader" i18n="@@invitationsSent.columnExpires">
          Utløper
        </div>
        <div class="cell actions" role="columnheader" i18n="@@invitationsSent.columnActions">
          Handlinger
        </div>
      </div>

      @for (invitation of invitations(); track invitation.id) {
        <div class="table-row" role="row">
          <div class="cell email" role="cell">{{ invitation.invitedEmail }}</div>
          <div class="cell role" role="cell">{{ invitation.role | titlecase }}</div>
          <div class="cell status" role="cell">
            <span class="badge" [class]="getStatusClass(invitation.status)">
              {{ invitation.status | titlecase }}
            </span>
          </div>
          <div class="cell date" role="cell">
            {{ invitation.createdAt | date: 'short' }}
          </div>
          <div class="cell expires" role="cell">
            {{ invitation.expiresAt | date: 'short' }}
          </div>
          <div class="cell actions" role="cell">
            @if (canCancel(invitation)) {
              <button
                type="button"
                class="btn btn-danger btn-sm"
                (click)="cancelInvitation(invitation)"
                [disabled]="isLoading()"
                [attr.aria-label]="'Avbryt invitasjon til ' + invitation.invitedEmail"
                i18n="@@invitationsSent.cancel"
              >
                Avbryt
              </button>
            }
          </div>
        </div>
      }
    </div>
  }
</div>
