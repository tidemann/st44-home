<app-modal [open]="open()" (closeModal)="onClose()" title="Add Child">
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label class="form-label" for="child-name">Child's Name *</label>
      <input
        type="text"
        id="child-name"
        class="form-input"
        formControlName="name"
        placeholder="e.g., Emma"
        [class.error]="form.controls.name.invalid && form.controls.name.touched"
        [attr.aria-invalid]="form.controls.name.invalid && form.controls.name.touched"
        [attr.aria-describedby]="
          form.controls.name.invalid && form.controls.name.touched ? 'child-name-error' : null
        "
      />
      @if (form.controls.name.invalid && form.controls.name.touched) {
        <div id="child-name-error" class="form-error" role="alert">
          @if (form.controls.name.errors?.['required']) {
            Child's name is required
          }
          @if (form.controls.name.errors?.['maxlength']) {
            Name is too long (max 255 characters)
          }
        </div>
      }
    </div>

    <div class="form-group">
      <label class="form-label" for="child-age">Age *</label>
      <input
        type="number"
        id="child-age"
        class="form-input"
        formControlName="age"
        placeholder="e.g., 10"
        min="1"
        max="18"
        [class.error]="form.controls.age.invalid && form.controls.age.touched"
        [attr.aria-invalid]="form.controls.age.invalid && form.controls.age.touched"
        [attr.aria-describedby]="
          form.controls.age.invalid && form.controls.age.touched ? 'child-age-error' : null
        "
      />
      @if (form.controls.age.invalid && form.controls.age.touched) {
        <div id="child-age-error" class="form-error" role="alert">
          @if (form.controls.age.errors?.['required']) {
            Age is required
          }
          @if (form.controls.age.errors?.['min']) {
            Age must be at least 1
          }
          @if (form.controls.age.errors?.['max']) {
            Age must be at most 18
          }
        </div>
      }
    </div>

    <div class="form-group">
      <label class="form-label" for="child-avatar">Avatar Emoji</label>
      <select id="child-avatar" class="form-select avatar-select" formControlName="avatar">
        @for (option of avatarOptions; track option.value) {
          <option [value]="option.value">{{ option.label }}</option>
        }
      </select>
    </div>

    <div class="modal-actions" modal-actions>
      <button type="button" class="btn btn-secondary" (click)="onCancel()">Cancel</button>
      <button type="submit" class="btn btn-primary" [disabled]="form.invalid || submitting()">
        Add Child
      </button>
    </div>
  </form>
</app-modal>
