<app-modal
  [open]="open()"
  (closeModal)="onClose()"
  i18n-title="@@addChildModal.title"
  title="Legg til barn"
>
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label class="form-label" for="child-name" i18n="@@addChildModal.nameLabel"
        >Barnets navn *</label
      >
      <input
        type="text"
        id="child-name"
        class="form-input"
        formControlName="name"
        i18n-placeholder="@@addChildModal.namePlaceholder"
        placeholder="f.eks. Emma"
        [class.error]="form.controls.name.invalid && form.controls.name.touched"
        [attr.aria-invalid]="form.controls.name.invalid && form.controls.name.touched"
        [attr.aria-describedby]="
          form.controls.name.invalid && form.controls.name.touched ? 'child-name-error' : null
        "
      />
      @if (form.controls.name.invalid && form.controls.name.touched) {
        <div id="child-name-error" class="form-error" role="alert">
          @if (form.controls.name.errors?.['required']) {
            <span i18n="@@addChildModal.nameRequired">Barnets navn er obligatorisk</span>
          }
          @if (form.controls.name.errors?.['maxlength']) {
            <span i18n="@@addChildModal.nameTooLong">Navnet er for langt (maks 255 tegn)</span>
          }
        </div>
      }
    </div>

    <div class="form-group">
      <label class="form-label" for="child-age" i18n="@@addChildModal.ageLabel">Alder *</label>
      <input
        type="number"
        id="child-age"
        class="form-input"
        formControlName="age"
        i18n-placeholder="@@addChildModal.agePlaceholder"
        placeholder="f.eks. 10"
        min="1"
        max="18"
        [class.error]="form.controls.age.invalid && form.controls.age.touched"
        [attr.aria-invalid]="form.controls.age.invalid && form.controls.age.touched"
        [attr.aria-describedby]="
          form.controls.age.invalid && form.controls.age.touched ? 'child-age-error' : null
        "
      />
      @if (form.controls.age.invalid && form.controls.age.touched) {
        <div id="child-age-error" class="form-error" role="alert">
          @if (form.controls.age.errors?.['required']) {
            <span i18n="@@addChildModal.ageRequired">Alder er obligatorisk</span>
          }
          @if (form.controls.age.errors?.['min']) {
            <span i18n="@@addChildModal.ageMin">Alder må være minst 1</span>
          }
          @if (form.controls.age.errors?.['max']) {
            <span i18n="@@addChildModal.ageMax">Alder må være maks 18</span>
          }
        </div>
      }
    </div>

    <div class="form-group">
      <label class="form-label" for="child-avatar" i18n="@@addChildModal.avatarLabel"
        >Avatar-emoji</label
      >
      <select id="child-avatar" class="form-select avatar-select" formControlName="avatar">
        @for (option of avatarOptions; track option.value) {
          <option [value]="option.value">{{ option.label }}</option>
        }
      </select>
    </div>

    <div class="modal-actions" modal-actions>
      <button
        type="button"
        class="btn btn-secondary"
        (click)="onCancel()"
        i18n="@@addChildModal.cancelButton"
      >
        Avbryt
      </button>
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="form.invalid || submitting()"
        i18n="@@addChildModal.submitButton"
      >
        Legg til barn
      </button>
    </div>
  </form>
</app-modal>
