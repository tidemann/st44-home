<app-modal
  [open]="open()"
  (closeModal)="onClose()"
  i18n-title="@@inviteModal.title"
  title="Inviter familiemedlem"
>
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label class="form-label" for="invite-email" i18n="@@inviteModal.emailLabel"
        >E-postadresse *</label
      >
      <input
        type="email"
        id="invite-email"
        class="form-input"
        formControlName="email"
        i18n-placeholder="@@inviteModal.emailPlaceholder"
        placeholder="familie@eksempel.no"
        [class.error]="form.controls.email.invalid && form.controls.email.touched"
        [attr.aria-invalid]="form.controls.email.invalid && form.controls.email.touched"
        [attr.aria-describedby]="
          form.controls.email.invalid && form.controls.email.touched ? 'invite-email-error' : null
        "
      />
      @if (form.controls.email.invalid && form.controls.email.touched) {
        <div id="invite-email-error" class="form-error" role="alert">
          @if (form.controls.email.errors?.['required']) {
            <span i18n="@@inviteModal.emailRequired">E-postadresse er obligatorisk</span>
          }
          @if (form.controls.email.errors?.['email']) {
            <span i18n="@@inviteModal.emailInvalid">Vennligst oppgi en gyldig e-postadresse</span>
          }
        </div>
      }
    </div>

    <div class="form-group">
      <label class="form-label" for="invite-role" i18n="@@inviteModal.roleLabel">Rolle *</label>
      <select
        id="invite-role"
        class="form-select"
        formControlName="role"
        [class.error]="form.controls.role.invalid && form.controls.role.touched"
      >
        @for (option of roleOptions; track option.value) {
          <option [value]="option.value">{{ option.label }}</option>
        }
      </select>
      <div class="role-description">
        @if (form.value.role === 'parent') {
          <span i18n="@@inviteModal.parentRoleDescription"
            >Kan administrere oppgaver, barn og innstillinger</span
          >
        } @else {
          <span i18n="@@inviteModal.memberRoleDescription">Kan se og fullføre oppgaver</span>
        }
      </div>
    </div>

    <div class="form-group">
      <label class="form-label" for="invite-message" i18n="@@inviteModal.messageLabel"
        >Personlig melding (valgfritt)</label
      >
      <textarea
        id="invite-message"
        class="form-textarea"
        formControlName="message"
        i18n-placeholder="@@inviteModal.messagePlaceholder"
        placeholder="Bli med i husholdningen vår for å hjelpe til med oppgavene sammen!"
        rows="3"
      ></textarea>
    </div>

    <div class="modal-actions" modal-actions>
      <button
        type="button"
        class="btn btn-secondary"
        (click)="onCancel()"
        i18n="@@inviteModal.cancelButton"
      >
        Avbryt
      </button>
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="form.invalid || submitting()"
        i18n="@@inviteModal.submitButton"
      >
        Send invitasjon
      </button>
    </div>
  </form>
</app-modal>
