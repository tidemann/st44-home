<main class="dashboard" role="main" aria-label="Parent Dashboard">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      @if (household()) {
        <h1 class="household-name">{{ household()!.name }}</h1>
      } @else {
        <h1 class="household-name">Dashboard</h1>
      }
      <app-household-switcher (householdChanged)="onHouseholdChanged()" />
    </div>
    <nav class="header-actions" aria-label="Quick actions">
      <a routerLink="/household/settings" class="btn btn-icon" aria-label="Household settings">
        <span aria-hidden="true">âš™ï¸</span>
      </a>
    </nav>
  </header>

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="loading-state" role="status" aria-live="polite">
      <div class="loading-spinner" aria-hidden="true"></div>
      <p>Loading dashboard...</p>
    </div>
  }

  <!-- Error State -->
  @if (errorMessage()) {
    <div class="alert alert-error" role="alert">
      <p>{{ errorMessage() }}</p>
      <button type="button" class="btn btn-secondary" (click)="loadDashboard()">Try Again</button>
    </div>
  }

  <!-- Dashboard Content -->
  @if (!isLoading() && !errorMessage()) {
    <!-- Week Summary Card -->
    <section class="summary-card" aria-labelledby="week-summary-title">
      <h2 id="week-summary-title" class="section-title">
        <span aria-hidden="true">ğŸ“Š</span> This Week
      </h2>

      @if (hasTasks()) {
        <div class="summary-stats">
          <div class="stat-main">
            <span class="stat-value">{{ weekSummary().total }}</span>
            <span class="stat-label">Tasks</span>
          </div>
          <div class="stat-completion" [class]="getCompletionClass(weekSummary().completionRate)">
            <span class="stat-value">{{ weekSummary().completionRate }}%</span>
            <span class="stat-label">Complete</span>
          </div>
        </div>

        <div class="stat-breakdown">
          <span class="stat-item stat-completed" title="Completed tasks">
            <span aria-hidden="true">âœ…</span> {{ weekSummary().completed }}
          </span>
          <span class="stat-item stat-pending" title="Pending tasks">
            <span aria-hidden="true">â³</span> {{ weekSummary().pending }}
          </span>
          @if (weekSummary().overdue > 0) {
            <span class="stat-item stat-overdue" title="Overdue tasks">
              <span aria-hidden="true">âš ï¸</span> {{ weekSummary().overdue }}
            </span>
          }
        </div>
      } @else {
        <div class="empty-state">
          <p>No tasks this week. Create your first task!</p>
          <button type="button" class="btn btn-primary" disabled title="Coming soon">
            <span aria-hidden="true">+</span> Create Task
          </button>
        </div>
      }
    </section>

    <!-- Children Section -->
    <section class="children-section" aria-labelledby="children-title">
      <h2 id="children-title" class="section-title"><span aria-hidden="true">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span> Children</h2>

      @if (hasChildren()) {
        <ul class="children-list" role="list">
          @for (child of children(); track child.id) {
            <li class="child-item">
              <div class="child-info">
                <span class="child-name">{{ child.name }}</span>
                <span class="child-stats">
                  {{ child.tasksCompleted }}/{{ child.tasksTotal }} tasks
                </span>
              </div>
              <div class="progress-container">
                <div
                  class="progress-bar"
                  [class]="getCompletionClass(child.completionRate)"
                  [style.width.%]="child.completionRate"
                  role="progressbar"
                  [attr.aria-valuenow]="child.completionRate"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  [attr.aria-label]="child.name + ' completion: ' + child.completionRate + '%'"
                ></div>
              </div>
              <span class="completion-rate" [class]="getCompletionClass(child.completionRate)">
                {{ child.completionRate }}%
              </span>
            </li>
          }
        </ul>
      } @else {
        <div class="empty-state">
          <p>Add your children to start assigning tasks.</p>
          <a routerLink="/household/settings" class="btn btn-primary">
            <span aria-hidden="true">+</span> Add Child
          </a>
        </div>
      }
    </section>

    <!-- Quick Actions -->
    <footer class="quick-actions">
      <button type="button" class="btn btn-primary" disabled title="Coming soon">
        <span aria-hidden="true">+</span> Add Task
      </button>
      <a routerLink="/household/settings" class="btn btn-secondary">
        <span aria-hidden="true">ğŸ“‹</span> Manage Household
      </a>
    </footer>
  }
</main>
