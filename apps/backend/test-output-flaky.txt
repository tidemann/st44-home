
> backend@1.0.0 pretest
> cd ../../packages/types && npm run build


> @st44/types@1.0.0 build
> npm run clean && tsc


> @st44/types@1.0.0 clean
> node -e "require('fs').rmSync('dist', {recursive: true, force: true})"


> backend@1.0.0 test
> cross-env NODE_ENV=test tsx --test src/**/*.test.ts

TAP version 13
# Subtest: authenticateUser Middleware
    # Subtest: Authorization Header Validation
        # Subtest: should return 401 when Authorization header is missing
        ok 1 - should return 401 when Authorization header is missing
          ---
          duration_ms: 1.2575
          ...
        # Subtest: should return 401 when header does not start with Bearer
        ok 2 - should return 401 when header does not start with Bearer
          ---
          duration_ms: 0.3664
          ...
        1..2
    ok 1 - Authorization Header Validation
      ---
      duration_ms: 2.6748
      type: 'suite'
      ...
    # Subtest: Token Validation
        # Subtest: should return 401 for malformed token
        ok 1 - should return 401 for malformed token
          ---
          duration_ms: 0.7282
          ...
        # Subtest: should return 401 for expired token
        ok 2 - should return 401 for expired token
          ---
          duration_ms: 14.5892
          ...
        # Subtest: should return 401 for token with wrong secret
        ok 3 - should return 401 for token with wrong secret
          ---
          duration_ms: 3.5757
          ...
        # Subtest: should return 401 for refresh token (wrong type)
        ok 4 - should return 401 for refresh token (wrong type)
          ---
          duration_ms: 2.6738
          ...
        1..4
    ok 2 - Token Validation
      ---
      duration_ms: 22.0732
      type: 'suite'
      ...
    # Subtest: Successful Authentication
        # Subtest: should authenticate valid access token
        ok 1 - should authenticate valid access token
          ---
          duration_ms: 4.9012
          ...
        # Subtest: should handle UUID user IDs
        ok 2 - should handle UUID user IDs
          ---
          duration_ms: 5.4775
          ...
        1..2
    ok 3 - Successful Authentication
      ---
      duration_ms: 11.2182
      type: 'suite'
      ...
    1..3
ok 1 - authenticateUser Middleware
  ---
  duration_ms: 36.8795
  type: 'suite'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086408:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086408:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086408:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086408:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\middleware\\household-membership.test.ts
not ok 2 - src\\middleware\\household-membership.test.ts
  ---
  duration_ms: 783.2741
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\middleware\\household-membership.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: AssignmentRepository
    # Subtest: findById
        # Subtest: should return an assignment when found
        ok 1 - should return an assignment when found
          ---
          duration_ms: 3.8474
          ...
        # Subtest: should return null when assignment not found
        ok 2 - should return null when assignment not found
          ---
          duration_ms: 0.5894
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 1.4082
          ...
        1..3
    ok 1 - findById
      ---
      duration_ms: 7.0198
      type: 'suite'
      ...
    # Subtest: findByIdWithDetails
        # Subtest: should return assignment with details when found
        ok 1 - should return assignment with details when found
          ---
          duration_ms: 0.945
          ...
        # Subtest: should return completed assignment with completedAt
        ok 2 - should return completed assignment with completedAt
          ---
          duration_ms: 0.7925
          ...
        # Subtest: should return null when not found
        ok 3 - should return null when not found
          ---
          duration_ms: 0.4239
          ...
        1..3
    ok 2 - findByIdWithDetails
      ---
      duration_ms: 2.8304
      type: 'suite'
      ...
    # Subtest: findByChild
        # Subtest: should return assignments for a child within date range
        ok 1 - should return assignments for a child within date range
          ---
          duration_ms: 0.6084
          ...
        # Subtest: should return empty array when no assignments found
        ok 2 - should return empty array when no assignments found
          ---
          duration_ms: 0.3284
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 0.5581
          ...
        1..3
    ok 3 - findByChild
      ---
      duration_ms: 1.9137
      type: 'suite'
      ...
    # Subtest: findByHousehold
        # Subtest: should return assignments for a household within date range
        ok 1 - should return assignments for a household within date range
          ---
          duration_ms: 0.6872
          ...
        # Subtest: should apply child filter
        ok 2 - should apply child filter
          ---
          duration_ms: 0.4089
          ...
        # Subtest: should apply status filter
        ok 3 - should apply status filter
          ---
          duration_ms: 0.6264
          ...
        # Subtest: should apply task filter
        ok 4 - should apply task filter
          ---
          duration_ms: 0.39
          ...
        # Subtest: should apply multiple filters
        ok 5 - should apply multiple filters
          ---
          duration_ms: 0.4364
          ...
        1..5
    ok 4 - findByHousehold
      ---
      duration_ms: 2.8683
      type: 'suite'
      ...
    # Subtest: findPending
        # Subtest: should return pending assignments for a child
        ok 1 - should return pending assignments for a child
          ---
          duration_ms: 0.4653
          ...
        # Subtest: should call query with correct parameters
        ok 2 - should call query with correct parameters
          ---
          duration_ms: 0.3248
          ...
        1..2
    ok 5 - findPending
      ---
      duration_ms: 0.9441
      type: 'suite'
      ...
    # Subtest: create
        # Subtest: should create a new assignment
        ok 1 - should create a new assignment
          ---
          duration_ms: 0.4652
          ...
        # Subtest: should use provided status
        ok 2 - should use provided status
          ---
          duration_ms: 0.3451
          ...
        # Subtest: should default to pending status
        ok 3 - should default to pending status
          ---
          duration_ms: 2.1247
          ...
        1..3
    ok 6 - create
      ---
      duration_ms: 3.1697
      type: 'suite'
      ...
    # Subtest: batchCreate
        # Subtest: should create multiple assignments
        ok 1 - should create multiple assignments
          ---
          duration_ms: 0.6393
          ...
        # Subtest: should return empty array when no assignments provided
        ok 2 - should return empty array when no assignments provided
          ---
          duration_ms: 0.2631
          ...
        # Subtest: should use ON CONFLICT DO NOTHING for duplicates
        ok 3 - should use ON CONFLICT DO NOTHING for duplicates
          ---
          duration_ms: 0.387
          ...
        1..3
    ok 7 - batchCreate
      ---
      duration_ms: 1.5212
      type: 'suite'
      ...
    # Subtest: updateStatus
        # Subtest: should update assignment status and return true
        ok 1 - should update assignment status and return true
          ---
          duration_ms: 0.4124
          ...
        # Subtest: should return false when assignment not found
        ok 2 - should return false when assignment not found
          ---
          duration_ms: 0.2795
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 0.3115
          ...
        1..3
    ok 8 - updateStatus
      ---
      duration_ms: 1.2005
      type: 'suite'
      ...
    # Subtest: completeIfPending
        # Subtest: should complete pending assignment and return it
        ok 1 - should complete pending assignment and return it
          ---
          duration_ms: 0.4285
          ...
        # Subtest: should return null if not pending
        ok 2 - should return null if not pending
          ---
          duration_ms: 0.2611
          ...
        # Subtest: should only update if status is pending
        ok 3 - should only update if status is pending
          ---
          duration_ms: 0.2737
          ...
        1..3
    ok 9 - completeIfPending
      ---
      duration_ms: 1.144
      type: 'suite'
      ...
    # Subtest: reassign
        # Subtest: should reassign pending assignment to new child
        ok 1 - should reassign pending assignment to new child
          ---
          duration_ms: 0.4326
          ...
        # Subtest: should return null if not pending
        ok 2 - should return null if not pending
          ---
          duration_ms: 0.5808
          ...
        # Subtest: should only reassign if pending
        ok 3 - should only reassign if pending
          ---
          duration_ms: 0.2867
          ...
        1..3
    ok 10 - reassign
      ---
      duration_ms: 1.5911
      type: 'suite'
      ...
    # Subtest: delete
        # Subtest: should delete assignment and return true
        ok 1 - should delete assignment and return true
          ---
          duration_ms: 0.3836
          ...
        # Subtest: should return false when assignment not found
        ok 2 - should return false when assignment not found
          ---
          duration_ms: 0.2491
          ...
        1..2
    ok 11 - delete
      ---
      duration_ms: 0.7637
      type: 'suite'
      ...
    # Subtest: getHouseholdId
        # Subtest: should return household ID for assignment
        ok 1 - should return household ID for assignment
          ---
          duration_ms: 0.3218
          ...
        # Subtest: should return null when assignment not found
        ok 2 - should return null when assignment not found
          ---
          duration_ms: 0.2625
          ...
        1..2
    ok 12 - getHouseholdId
      ---
      duration_ms: 0.7095
      type: 'suite'
      ...
    # Subtest: exists
        # Subtest: should return true when assignment exists with child
        ok 1 - should return true when assignment exists with child
          ---
          duration_ms: 0.4039
          ...
        # Subtest: should return true when assignment exists without child
        ok 2 - should return true when assignment exists without child
          ---
          duration_ms: 0.308
          ...
        # Subtest: should return false when assignment does not exist
        ok 3 - should return false when assignment does not exist
          ---
          duration_ms: 0.2392
          ...
        # Subtest: should use IS NULL for null childId
        ok 4 - should use IS NULL for null childId
          ---
          duration_ms: 0.4196
          ...
        # Subtest: should use = $2 for non-null childId
        ok 5 - should use = $2 for non-null childId
          ---
          duration_ms: 0.9362
          ...
        1..5
    ok 13 - exists
      ---
      duration_ms: 2.5972
      type: 'suite'
      ...
    # Subtest: createCompletion
        # Subtest: should create a task completion record
        ok 1 - should create a task completion record
          ---
          duration_ms: 1.1745
          ...
        # Subtest: should call query with correct parameters
        ok 2 - should call query with correct parameters
          ---
          duration_ms: 0.4229
          ...
        1..2
    ok 14 - createCompletion
      ---
      duration_ms: 1.8009
      type: 'suite'
      ...
    # Subtest: findCompletionByAssignment
        # Subtest: should return completion when found
        ok 1 - should return completion when found
          ---
          duration_ms: 0.4139
          ...
        # Subtest: should return null when not found
        ok 2 - should return null when not found
          ---
          duration_ms: 0.3195
          ...
        1..2
    ok 15 - findCompletionByAssignment
      ---
      duration_ms: 0.8713
      type: 'suite'
      ...
    # Subtest: getAssignmentWithPoints
        # Subtest: should return assignment with task points
        ok 1 - should return assignment with task points
          ---
          duration_ms: 12.877
          ...
        # Subtest: should return null when not found
        ok 2 - should return null when not found
          ---
          duration_ms: 0.5817
          ...
        1..2
    ok 16 - getAssignmentWithPoints
      ---
      duration_ms: 16.1105
      type: 'suite'
      ...
    # Subtest: withClient
        # Subtest: should create a new repository instance with client
        ok 1 - should create a new repository instance with client
          ---
          duration_ms: 0.3436
          ...
        1..1
    ok 17 - withClient
      ---
      duration_ms: 0.4576
      type: 'suite'
      ...
    1..17
ok 3 - AssignmentRepository
  ---
  duration_ms: 49.5305
  type: 'suite'
  ...
# Subtest: ChildRepository
    # Subtest: findById
        # Subtest: should return a child when found
        ok 1 - should return a child when found
          ---
          duration_ms: 3.598
          ...
        # Subtest: should return null when child not found
        ok 2 - should return null when child not found
          ---
          duration_ms: 0.4416
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 2.4198
          ...
        1..3
    ok 1 - findById
      ---
      duration_ms: 7.4737
      type: 'suite'
      ...
    # Subtest: findByIdAndHousehold
        # Subtest: should return a child when found in household
        ok 1 - should return a child when found in household
          ---
          duration_ms: 0.8175
          ...
        # Subtest: should return null when child not in household
        ok 2 - should return null when child not in household
          ---
          duration_ms: 0.6898
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 0.596
          ...
        1..3
    ok 2 - findByIdAndHousehold
      ---
      duration_ms: 3.5644
      type: 'suite'
      ...
    # Subtest: findByHousehold
        # Subtest: should return all children for a household
        ok 1 - should return all children for a household
          ---
          duration_ms: 0.6686
          ...
        # Subtest: should return empty array when no children
        ok 2 - should return empty array when no children
          ---
          duration_ms: 0.3881
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 0.7605
          ...
        1..3
    ok 3 - findByHousehold
      ---
      duration_ms: 2.4949
      type: 'suite'
      ...
    # Subtest: findByHouseholdWithPoints
        # Subtest: should return children with points balance
        ok 1 - should return children with points balance
          ---
          duration_ms: 0.6177
          ...
        1..1
    ok 4 - findByHouseholdWithPoints
      ---
      duration_ms: 0.7767
      type: 'suite'
      ...
    # Subtest: findByUserId
        # Subtest: should return a child when found by user ID
        ok 1 - should return a child when found by user ID
          ---
          duration_ms: 0.467
          ...
        # Subtest: should return null when no child linked to user
        ok 2 - should return null when no child linked to user
          ---
          duration_ms: 0.3657
          ...
        1..2
    ok 5 - findByUserId
      ---
      duration_ms: 1.0198
      type: 'suite'
      ...
    # Subtest: findByUserIdAndHousehold
        # Subtest: should return a child when found by user ID and household
        ok 1 - should return a child when found by user ID and household
          ---
          duration_ms: 0.5717
          ...
        # Subtest: should return null when child not found
        ok 2 - should return null when child not found
          ---
          duration_ms: 0.7972
          ...
        1..2
    ok 6 - findByUserIdAndHousehold
      ---
      duration_ms: 1.6415
      type: 'suite'
      ...
    # Subtest: create
        # Subtest: should create a new child
        ok 1 - should create a new child
          ---
          duration_ms: 0.5942
          ...
        # Subtest: should call query with correct INSERT statement
        ok 2 - should call query with correct INSERT statement
          ---
          duration_ms: 0.3798
          ...
        # Subtest: should handle optional fields
        ok 3 - should handle optional fields
          ---
          duration_ms: 0.3742
          ...
        1..3
    ok 7 - create
      ---
      duration_ms: 1.6554
      type: 'suite'
      ...
    # Subtest: update
        # Subtest: should update child name
        ok 1 - should update child name
          ---
          duration_ms: 0.5343
          ...
        # Subtest: should update birth year
        ok 2 - should update birth year
          ---
          duration_ms: 3.1324
          ...
        # Subtest: should return null when child not found
        ok 3 - should return null when child not found
          ---
          duration_ms: 0.3826
          ...
        # Subtest: should return current child when no updates provided
        ok 4 - should return current child when no updates provided
          ---
          duration_ms: 0.3845
          ...
        1..4
    ok 8 - update
      ---
      duration_ms: 4.7318
      type: 'suite'
      ...
    # Subtest: delete
        # Subtest: should delete a child and return true
        ok 1 - should delete a child and return true
          ---
          duration_ms: 4.308
          ...
        # Subtest: should return false when child not found
        ok 2 - should return false when child not found
          ---
          duration_ms: 1.1931
          ...
        # Subtest: should call query with correct DELETE statement
        ok 3 - should call query with correct DELETE statement
          ---
          duration_ms: 0.4554
          ...
        1..3
    ok 9 - delete
      ---
      duration_ms: 6.2863
      type: 'suite'
      ...
    # Subtest: linkToUser
        # Subtest: should link child to user and return true
        ok 1 - should link child to user and return true
          ---
          duration_ms: 0.4332
          ...
        # Subtest: should return false when child not found
        ok 2 - should return false when child not found
          ---
          duration_ms: 0.2672
          ...
        1..2
    ok 10 - linkToUser
      ---
      duration_ms: 0.8828
      type: 'suite'
      ...
    # Subtest: unlinkFromUser
        # Subtest: should unlink child from user and return true
        ok 1 - should unlink child from user and return true
          ---
          duration_ms: 0.344
          ...
        # Subtest: should return false when child not found
        ok 2 - should return false when child not found
          ---
          duration_ms: 0.2956
          ...
        1..2
    ok 11 - unlinkFromUser
      ---
      duration_ms: 0.8344
      type: 'suite'
      ...
    # Subtest: getHouseholdId
        # Subtest: should return household ID for child
        ok 1 - should return household ID for child
          ---
          duration_ms: 7.0316
          ...
        # Subtest: should return null when child not found
        ok 2 - should return null when child not found
          ---
          duration_ms: 0.5794
          ...
        1..2
    ok 12 - getHouseholdId
      ---
      duration_ms: 7.8606
      type: 'suite'
      ...
    # Subtest: belongsToHousehold
        # Subtest: should return true when child belongs to household
        ok 1 - should return true when child belongs to household
          ---
          duration_ms: 0.5086
          ...
        # Subtest: should return false when child does not belong to household
        ok 2 - should return false when child does not belong to household
          ---
          duration_ms: 7.8767
          ...
        1..2
    ok 13 - belongsToHousehold
      ---
      duration_ms: 8.8895
      type: 'suite'
      ...
    # Subtest: countByHousehold
        # Subtest: should return count of children
        ok 1 - should return count of children
          ---
          duration_ms: 0.5099
          ...
        # Subtest: should return 0 when no children
        ok 2 - should return 0 when no children
          ---
          duration_ms: 0.4194
          ...
        1..2
    ok 14 - countByHousehold
      ---
      duration_ms: 1.1744
      type: 'suite'
      ...
    # Subtest: getPointsBalance
        # Subtest: should return points balance for child
        ok 1 - should return points balance for child
          ---
          duration_ms: 0.486
          ...
        # Subtest: should return zeros when no points data exists
        ok 2 - should return zeros when no points data exists
          ---
          duration_ms: 0.2947
          ...
        1..2
    ok 15 - getPointsBalance
      ---
      duration_ms: 0.9485
      type: 'suite'
      ...
    # Subtest: withClient
        # Subtest: should create a new repository instance with client
        ok 1 - should create a new repository instance with client
          ---
          duration_ms: 0.7521
          ...
        1..1
    ok 16 - withClient
      ---
      duration_ms: 0.8639
      type: 'suite'
      ...
    1..16
ok 4 - ChildRepository
  ---
  duration_ms: 53.7922
  type: 'suite'
  ...
# Subtest: HouseholdRepository
    # Subtest: findById
        # Subtest: should return a household when found
        ok 1 - should return a household when found
          ---
          duration_ms: 5.6429
          ...
        # Subtest: should return null when household not found
        ok 2 - should return null when household not found
          ---
          duration_ms: 0.5842
          ...
        1..2
    ok 1 - findById
      ---
      duration_ms: 7.2962
      type: 'suite'
      ...
    # Subtest: findByIdWithCounts
        # Subtest: should return household with member and children counts
        ok 1 - should return household with member and children counts
          ---
          duration_ms: 0.795
          ...
        # Subtest: should return null when household not found
        ok 2 - should return null when household not found
          ---
          duration_ms: 0.5028
          ...
        1..2
    ok 2 - findByIdWithCounts
      ---
      duration_ms: 1.6335
      type: 'suite'
      ...
    # Subtest: create
        # Subtest: should create a new household
        ok 1 - should create a new household
          ---
          duration_ms: 14.7661
          ...
        # Subtest: should trim household name
        ok 2 - should trim household name
          ---
          duration_ms: 0.5826
          ...
        1..2
    ok 3 - create
      ---
      duration_ms: 15.7724
      type: 'suite'
      ...
    # Subtest: update
        # Subtest: should update household name
        ok 1 - should update household name
          ---
          duration_ms: 0.5065
          ...
        # Subtest: should return null when household not found
        ok 2 - should return null when household not found
          ---
          duration_ms: 0.3092
          ...
        1..2
    ok 4 - update
      ---
      duration_ms: 1.0574
      type: 'suite'
      ...
    # Subtest: delete
        # Subtest: should return true when household is deleted
        ok 1 - should return true when household is deleted
          ---
          duration_ms: 0.5632
          ...
        # Subtest: should return false when household not found
        ok 2 - should return false when household not found
          ---
          duration_ms: 0.3384
          ...
        1..2
    ok 5 - delete
      ---
      duration_ms: 1.0554
      type: 'suite'
      ...
    # Subtest: findByUserId
        # Subtest: should return all households for a user
        ok 1 - should return all households for a user
          ---
          duration_ms: 1.0572
          ...
        # Subtest: should return empty array when user has no households
        ok 2 - should return empty array when user has no households
          ---
          duration_ms: 1.2694
          ...
        1..2
    ok 6 - findByUserId
      ---
      duration_ms: 2.5221
      type: 'suite'
      ...
    # Subtest: addMember
        # Subtest: should add a member to a household
        ok 1 - should add a member to a household
          ---
          duration_ms: 0.4235
          ...
        1..1
    ok 7 - addMember
      ---
      duration_ms: 0.5535
      type: 'suite'
      ...
    # Subtest: removeMember
        # Subtest: should return true when member is removed
        ok 1 - should return true when member is removed
          ---
          duration_ms: 0.4787
          ...
        # Subtest: should return false when member not found
        ok 2 - should return false when member not found
          ---
          duration_ms: 0.699
          ...
        1..2
    ok 8 - removeMember
      ---
      duration_ms: 1.3442
      type: 'suite'
      ...
    # Subtest: updateMemberRole
        # Subtest: should return true when role is updated
        ok 1 - should return true when role is updated
          ---
          duration_ms: 0.4187
          ...
        # Subtest: should return false when member not found
        ok 2 - should return false when member not found
          ---
          duration_ms: 0.376
          ...
        1..2
    ok 9 - updateMemberRole
      ---
      duration_ms: 1.0368
      type: 'suite'
      ...
    # Subtest: getMemberRole
        # Subtest: should return role when member exists
        ok 1 - should return role when member exists
          ---
          duration_ms: 0.5803
          ...
        # Subtest: should return null when member not found
        ok 2 - should return null when member not found
          ---
          duration_ms: 0.3104
          ...
        1..2
    ok 10 - getMemberRole
      ---
      duration_ms: 1.3134
      type: 'suite'
      ...
    # Subtest: getMembers
        # Subtest: should return all members of a household
        ok 1 - should return all members of a household
          ---
          duration_ms: 1.6844
          ...
        # Subtest: should return empty array when household has no members
        ok 2 - should return empty array when household has no members
          ---
          duration_ms: 0.6054
          ...
        1..2
    ok 11 - getMembers
      ---
      duration_ms: 2.8775
      type: 'suite'
      ...
    # Subtest: countAdmins
        # Subtest: should return count of admins
        ok 1 - should return count of admins
          ---
          duration_ms: 2.5461
          ...
        1..1
    ok 12 - countAdmins
      ---
      duration_ms: 3.0441
      type: 'suite'
      ...
    # Subtest: isMember
        # Subtest: should return true when user is a member
        ok 1 - should return true when user is a member
          ---
          duration_ms: 0.5534
          ...
        # Subtest: should return false when user is not a member
        ok 2 - should return false when user is not a member
          ---
          duration_ms: 0.6892
          ...
        1..2
    ok 13 - isMember
      ---
      duration_ms: 1.4553
      type: 'suite'
      ...
    # Subtest: withClient
        # Subtest: should create new repository with different executor
        ok 1 - should create new repository with different executor
          ---
          duration_ms: 1.0594
          ...
        1..1
    ok 14 - withClient
      ---
      duration_ms: 1.1817
      type: 'suite'
      ...
    1..14
ok 5 - HouseholdRepository
  ---
  duration_ms: 44.774
  type: 'suite'
  ...
# Subtest: TaskResponseRepository
    # Subtest: addCandidates
        # Subtest: should add multiple candidates to a task
        ok 1 - should add multiple candidates to a task
          ---
          duration_ms: 3.8267
          ...
        # Subtest: should return empty array when no child IDs provided
        ok 2 - should return empty array when no child IDs provided
          ---
          duration_ms: 0.5209
          ...
        1..2
    ok 1 - addCandidates
      ---
      duration_ms: 5.37
      type: 'suite'
      ...
    # Subtest: recordResponse
        # Subtest: should record an accept response
        ok 1 - should record an accept response
          ---
          duration_ms: 2.5909
          ...
        # Subtest: should record a decline response
        ok 2 - should record a decline response
          ---
          duration_ms: 0.6403
          ...
        1..2
    ok 2 - recordResponse
      ---
      duration_ms: 4.7315
      type: 'suite'
      ...
    # Subtest: undoResponse
        # Subtest: should delete a response and return true
        ok 1 - should delete a response and return true
          ---
          duration_ms: 0.7306
          ...
        # Subtest: should return false when no response to delete
        ok 2 - should return false when no response to delete
          ---
          duration_ms: 0.3877
          ...
        1..2
    ok 3 - undoResponse
      ---
      duration_ms: 1.5018
      type: 'suite'
      ...
    # Subtest: getTaskCandidates
        # Subtest: should return candidates with response status
        ok 1 - should return candidates with response status
          ---
          duration_ms: 5.3953
          ...
        1..1
    ok 4 - getTaskCandidates
      ---
      duration_ms: 5.7059
      type: 'suite'
      ...
    # Subtest: getAvailableTasksForChild
        # Subtest: should return available tasks with deadline info
        ok 1 - should return available tasks with deadline info
          ---
          duration_ms: 0.868
          ...
        # Subtest: should calculate days until deadline correctly
        ok 2 - should calculate days until deadline correctly
          ---
          duration_ms: 0.6879
          ...
        1..2
    ok 5 - getAvailableTasksForChild
      ---
      duration_ms: 1.9231
      type: 'suite'
      ...
    # Subtest: getFailedTasks
        # Subtest: should return tasks where all candidates declined
        ok 1 - should return tasks where all candidates declined
          ---
          duration_ms: 0.7146
          ...
        1..1
    ok 6 - getFailedTasks
      ---
      duration_ms: 0.8461
      type: 'suite'
      ...
    # Subtest: getExpiredTasks
        # Subtest: should return tasks past deadline
        ok 1 - should return tasks past deadline
          ---
          duration_ms: 0.5858
          ...
        1..1
    ok 7 - getExpiredTasks
      ---
      duration_ms: 0.7385
      type: 'suite'
      ...
    # Subtest: hasTaskBeenAccepted
        # Subtest: should return true when task has assignment
        ok 1 - should return true when task has assignment
          ---
          duration_ms: 3.1265
          ...
        # Subtest: should return false when task has no assignment
        ok 2 - should return false when task has no assignment
          ---
          duration_ms: 0.6399
          ...
        1..2
    ok 8 - hasTaskBeenAccepted
      ---
      duration_ms: 4.0586
      type: 'suite'
      ...
    # Subtest: haveAllCandidatesDeclined
        # Subtest: should return true when all declined
        ok 1 - should return true when all declined
          ---
          duration_ms: 0.5176
          ...
        # Subtest: should return false when not all declined
        ok 2 - should return false when not all declined
          ---
          duration_ms: 0.4639
          ...
        1..2
    ok 9 - haveAllCandidatesDeclined
      ---
      duration_ms: 1.3449
      type: 'suite'
      ...
    # Subtest: getResponse
        # Subtest: should return response when exists
        ok 1 - should return response when exists
          ---
          duration_ms: 0.964
          ...
        # Subtest: should return null when no response
        ok 2 - should return null when no response
          ---
          duration_ms: 0.3968
          ...
        1..2
    ok 10 - getResponse
      ---
      duration_ms: 1.6725
      type: 'suite'
      ...
    # Subtest: isCandidate
        # Subtest: should return true when child is candidate
        ok 1 - should return true when child is candidate
          ---
          duration_ms: 0.6333
          ...
        # Subtest: should return false when child is not candidate
        ok 2 - should return false when child is not candidate
          ---
          duration_ms: 0.3628
          ...
        1..2
    ok 11 - isCandidate
      ---
      duration_ms: 1.265
      type: 'suite'
      ...
    1..11
ok 6 - TaskResponseRepository
  ---
  duration_ms: 32.1952
  type: 'suite'
  ...
# Subtest: TaskRepository
    # Subtest: findById
        # Subtest: should return a task when found
        ok 1 - should return a task when found
          ---
          duration_ms: 14.068
          ...
        # Subtest: should return null when task not found
        ok 2 - should return null when task not found
          ---
          duration_ms: 0.4586
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 1.8676
          ...
        1..3
    ok 1 - findById
      ---
      duration_ms: 17.5354
      type: 'suite'
      ...
    # Subtest: findByIdAndHousehold
        # Subtest: should return task when found with matching household
        ok 1 - should return task when found with matching household
          ---
          duration_ms: 0.959
          ...
        # Subtest: should return null when household does not match
        ok 2 - should return null when household does not match
          ---
          duration_ms: 0.6882
          ...
        1..2
    ok 2 - findByIdAndHousehold
      ---
      duration_ms: 2.1833
      type: 'suite'
      ...
    # Subtest: findByHousehold
        # Subtest: should return all tasks for a household
        ok 1 - should return all tasks for a household
          ---
          duration_ms: 0.6618
          ...
        # Subtest: should return empty array when no tasks found
        ok 2 - should return empty array when no tasks found
          ---
          duration_ms: 0.4657
          ...
        1..2
    ok 3 - findByHousehold
      ---
      duration_ms: 1.3818
      type: 'suite'
      ...
    # Subtest: findActiveByHousehold
        # Subtest: should only return active tasks
        ok 1 - should only return active tasks
          ---
          duration_ms: 0.3161
          ...
        1..1
    ok 4 - findActiveByHousehold
      ---
      duration_ms: 4.9731
      type: 'suite'
      ...
    # Subtest: create
        # Subtest: should create a new task with default values
        ok 1 - should create a new task with default values
          ---
          duration_ms: 0.9779
          ...
        # Subtest: should create task with all provided values
        ok 2 - should create task with all provided values
          ---
          duration_ms: 0.9569
          ...
        # Subtest: should trim task name
        ok 3 - should trim task name
          ---
          duration_ms: 0.4343
          ...
        1..3
    ok 5 - create
      ---
      duration_ms: 2.7861
      type: 'suite'
      ...
    # Subtest: update
        # Subtest: should update task with provided fields
        ok 1 - should update task with provided fields
          ---
          duration_ms: 1.1871
          ...
        # Subtest: should return null when task not found
        ok 2 - should return null when task not found
          ---
          duration_ms: 0.7327
          ...
        # Subtest: should return existing task when no fields to update
        ok 3 - should return existing task when no fields to update
          ---
          duration_ms: 0.546
          ...
        1..3
    ok 6 - update
      ---
      duration_ms: 3.0915
      type: 'suite'
      ...
    # Subtest: deactivate
        # Subtest: should return true when task is deactivated
        ok 1 - should return true when task is deactivated
          ---
          duration_ms: 0.9701
          ...
        # Subtest: should return false when task not found
        ok 2 - should return false when task not found
          ---
          duration_ms: 0.4127
          ...
        1..2
    ok 7 - deactivate
      ---
      duration_ms: 1.5855
      type: 'suite'
      ...
    # Subtest: list
        # Subtest: should return paginated results
        ok 1 - should return paginated results
          ---
          duration_ms: 0.6376
          ...
        # Subtest: should filter by active status
        ok 2 - should filter by active status
          ---
          duration_ms: 0.4286
          ...
        # Subtest: should apply sorting
        ok 3 - should apply sorting
          ---
          duration_ms: 0.4071
          ...
        1..3
    ok 8 - list
      ---
      duration_ms: 1.6818
      type: 'suite'
      ...
    # Subtest: countChildrenInHousehold
        # Subtest: should return count of children in household
        ok 1 - should return count of children in household
          ---
          duration_ms: 0.5876
          ...
        # Subtest: should return 0 for empty child array
        ok 2 - should return 0 for empty child array
          ---
          duration_ms: 0.2767
          ...
        1..2
    ok 9 - countChildrenInHousehold
      ---
      duration_ms: 1.1454
      type: 'suite'
      ...
    # Subtest: getHouseholdId
        # Subtest: should return household ID for a task
        ok 1 - should return household ID for a task
          ---
          duration_ms: 1.8139
          ...
        # Subtest: should return null when task not found
        ok 2 - should return null when task not found
          ---
          duration_ms: 0.2819
          ...
        1..2
    ok 10 - getHouseholdId
      ---
      duration_ms: 2.2878
      type: 'suite'
      ...
    # Subtest: withClient
        # Subtest: should create new repository with different executor
        ok 1 - should create new repository with different executor
          ---
          duration_ms: 0.3247
          ...
        1..1
    ok 11 - withClient
      ---
      duration_ms: 0.419
      type: 'suite'
      ...
    # Subtest: rule config parsing
        # Subtest: should parse rule config from JSON string
        ok 1 - should parse rule config from JSON string
          ---
          duration_ms: 0.3978
          ...
        # Subtest: should handle camelCase rule config
        ok 2 - should handle camelCase rule config
          ---
          duration_ms: 0.3374
          ...
        # Subtest: should handle snake_case rule config
        ok 3 - should handle snake_case rule config
          ---
          duration_ms: 0.3575
          ...
        1..3
    ok 12 - rule config parsing
      ---
      duration_ms: 1.2485
      type: 'suite'
      ...
    1..12
ok 7 - TaskRepository
  ---
  duration_ms: 42.0802
  type: 'suite'
  ...
# Subtest: UserRepository
    # Subtest: findById
        # Subtest: should return a user when found
        ok 1 - should return a user when found
          ---
          duration_ms: 3.8063
          ...
        # Subtest: should return null when user not found
        ok 2 - should return null when user not found
          ---
          duration_ms: 0.5285
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 2.1193
          ...
        1..3
    ok 1 - findById
      ---
      duration_ms: 23.3933
      type: 'suite'
      ...
    # Subtest: findByEmail
        # Subtest: should return a user when found by email
        ok 1 - should return a user when found by email
          ---
          duration_ms: 3.8212
          ...
        # Subtest: should lowercase email before querying
        ok 2 - should lowercase email before querying
          ---
          duration_ms: 1.8482
          ...
        # Subtest: should return null when user not found
        ok 3 - should return null when user not found
          ---
          duration_ms: 1.0118
          ...
        1..3
    ok 2 - findByEmail
      ---
      duration_ms: 7.3372
      type: 'suite'
      ...
    # Subtest: findByOAuth
        # Subtest: should return a user when found by OAuth provider
        ok 1 - should return a user when found by OAuth provider
          ---
          duration_ms: 0.5186
          ...
        # Subtest: should return null when OAuth user not found
        ok 2 - should return null when OAuth user not found
          ---
          duration_ms: 0.6258
          ...
        # Subtest: should call query with correct parameters
        ok 3 - should call query with correct parameters
          ---
          duration_ms: 2.865
          ...
        1..3
    ok 3 - findByOAuth
      ---
      duration_ms: 4.7348
      type: 'suite'
      ...
    # Subtest: create
        # Subtest: should create a new user with password
        ok 1 - should create a new user with password
          ---
          duration_ms: 0.6413
          ...
        # Subtest: should create a new OAuth user
        ok 2 - should create a new OAuth user
          ---
          duration_ms: 0.3899
          ...
        # Subtest: should lowercase email before inserting
        ok 3 - should lowercase email before inserting
          ---
          duration_ms: 0.3161
          ...
        # Subtest: should handle optional fields as null
        ok 4 - should handle optional fields as null
          ---
          duration_ms: 0.3739
          ...
        1..4
    ok 4 - create
      ---
      duration_ms: 2.0715
      type: 'suite'
      ...
    # Subtest: update
        # Subtest: should update user email
        ok 1 - should update user email
          ---
          duration_ms: 1.0299
          ...
        # Subtest: should update user name
        ok 2 - should update user name
          ---
          duration_ms: 0.6216
          ...
        # Subtest: should return null when user not found
        ok 3 - should return null when user not found
          ---
          duration_ms: 0.3927
          ...
        # Subtest: should return current user when no updates provided
        ok 4 - should return current user when no updates provided
          ---
          duration_ms: 1.096
          ...
        1..4
    ok 5 - update
      ---
      duration_ms: 20.4731
      type: 'suite'
      ...
    # Subtest: updatePassword
        # Subtest: should update password and return true
        ok 1 - should update password and return true
          ---
          duration_ms: 0.6518
          ...
        # Subtest: should return false when user not found
        ok 2 - should return false when user not found
          ---
          duration_ms: 0.4325
          ...
        1..2
    ok 6 - updatePassword
      ---
      duration_ms: 1.2813
      type: 'suite'
      ...
    # Subtest: delete
        # Subtest: should delete user and return true
        ok 1 - should delete user and return true
          ---
          duration_ms: 0.4757
          ...
        # Subtest: should return false when user not found
        ok 2 - should return false when user not found
          ---
          duration_ms: 1.9556
          ...
        1..2
    ok 7 - delete
      ---
      duration_ms: 2.6997
      type: 'suite'
      ...
    # Subtest: emailExists
        # Subtest: should return true when email exists
        ok 1 - should return true when email exists
          ---
          duration_ms: 0.4826
          ...
        # Subtest: should return false when email does not exist
        ok 2 - should return false when email does not exist
          ---
          duration_ms: 0.2935
          ...
        # Subtest: should lowercase email before checking
        ok 3 - should lowercase email before checking
          ---
          duration_ms: 0.3183
          ...
        1..3
    ok 8 - emailExists
      ---
      duration_ms: 1.3186
      type: 'suite'
      ...
    # Subtest: createPasswordResetToken
        # Subtest: should create a password reset token
        ok 1 - should create a password reset token
          ---
          duration_ms: 0.4897
          ...
        1..1
    ok 9 - createPasswordResetToken
      ---
      duration_ms: 0.6108
      type: 'suite'
      ...
    # Subtest: findValidPasswordResetToken
        # Subtest: should return token when valid and not expired
        ok 1 - should return token when valid and not expired
          ---
          duration_ms: 0.439
          ...
        # Subtest: should return null when token not found or expired
        ok 2 - should return null when token not found or expired
          ---
          duration_ms: 0.281
          ...
        # Subtest: should query with correct conditions
        ok 3 - should query with correct conditions
          ---
          duration_ms: 0.2934
          ...
        1..3
    ok 10 - findValidPasswordResetToken
      ---
      duration_ms: 1.2182
      type: 'suite'
      ...
    # Subtest: markPasswordResetTokenUsed
        # Subtest: should mark token as used and return true
        ok 1 - should mark token as used and return true
          ---
          duration_ms: 0.3795
          ...
        # Subtest: should return false when token not found
        ok 2 - should return false when token not found
          ---
          duration_ms: 0.3851
          ...
        1..2
    ok 11 - markPasswordResetTokenUsed
      ---
      duration_ms: 0.9096
      type: 'suite'
      ...
    # Subtest: deleteExpiredPasswordResetTokens
        # Subtest: should delete expired tokens and return count
        ok 1 - should delete expired tokens and return count
          ---
          duration_ms: 0.3281
          ...
        # Subtest: should return 0 when no tokens to delete
        ok 2 - should return 0 when no tokens to delete
          ---
          duration_ms: 0.3024
          ...
        1..2
    ok 12 - deleteExpiredPasswordResetTokens
      ---
      duration_ms: 0.7653
      type: 'suite'
      ...
    # Subtest: deleteAllPasswordResetTokens
        # Subtest: should delete all tokens for user and return count
        ok 1 - should delete all tokens for user and return count
          ---
          duration_ms: 0.3283
          ...
        1..1
    ok 13 - deleteAllPasswordResetTokens
      ---
      duration_ms: 0.421
      type: 'suite'
      ...
    # Subtest: getUserIdByPasswordResetToken
        # Subtest: should return user ID for valid token
        ok 1 - should return user ID for valid token
          ---
          duration_ms: 0.3537
          ...
        # Subtest: should return null for invalid token
        ok 2 - should return null for invalid token
          ---
          duration_ms: 0.25
          ...
        1..2
    ok 14 - getUserIdByPasswordResetToken
      ---
      duration_ms: 0.737
      type: 'suite'
      ...
    # Subtest: withClient
        # Subtest: should create a new repository instance with client
        ok 1 - should create a new repository instance with client
          ---
          duration_ms: 0.3178
          ...
        1..1
    ok 15 - withClient
      ---
      duration_ms: 0.4704
      type: 'suite'
      ...
    1..15
ok 8 - UserRepository
  ---
  duration_ms: 71.9133
  type: 'suite'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086599:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086599:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086599:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086599:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\analytics.test.ts
not ok 9 - src\\routes\\analytics.test.ts
  ---
  duration_ms: 914.9061
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\analytics.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086605:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086605:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086605:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086605:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\assignments.test.ts
not ok 10 - src\\routes\\assignments.test.ts
  ---
  duration_ms: 927.9287
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\assignments.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086610:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086610:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086610:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086610:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\auth.test.ts
not ok 11 - src\\routes\\auth.test.ts
  ---
  duration_ms: 905.4854
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\auth.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086616:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086616:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086616:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086616:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\children.test.ts
not ok 12 - src\\routes\\children.test.ts
  ---
  duration_ms: 721.8602
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\children.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086666:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086666:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086666:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483086666:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\households.test.ts
not ok 13 - src\\routes\\households.test.ts
  ---
  duration_ms: 926.9023
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\households.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087256:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087256:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087256:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087256:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\invitations.test.ts
not ok 14 - src\\routes\\invitations.test.ts
  ---
  duration_ms: 966.5683
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\invitations.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087248:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087248:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087248:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087248:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\single-tasks.test.ts
not ok 15 - src\\routes\\single-tasks.test.ts
  ---
  duration_ms: 965.6563
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\single-tasks.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087259:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087259:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087259:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087259:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\stats.test.ts
not ok 16 - src\\routes\\stats.test.ts
  ---
  duration_ms: 833.5119
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\stats.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087344:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087344:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087344:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087344:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\tasks.test.ts
not ok 17 - src\\routes\\tasks.test.ts
  ---
  duration_ms: 936.9777
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\tasks.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087306:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087306:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087306:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087306:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\routes\\user.test.ts
not ok 18 - src\\routes\\user.test.ts
  ---
  duration_ms: 621.0521
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\routes\\user.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# node:internal/modules/run_main:122
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'ioredis' imported from C:\\code\\st44-home\\apps\\backend\\src\\core\\redis.ts
#     at packageResolve (node:internal/modules/esm/resolve:857:9)
#     at moduleResolve (node:internal/modules/esm/resolve:926:18)
#     at defaultResolve (node:internal/modules/esm/resolve:1056:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087390:2:3744)
#     at resolveDirectory (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087390:2:4243)
#     at resolveTsPaths (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087390:2:4984)
#     at resolve (file:///C:/code/st44-home/node_modules/tsx/dist/esm/index.mjs?1767483087390:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at Hooks.resolve (node:internal/modules/esm/hooks:240:30) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.12.0
# Subtest: src\\server.test.ts
not ok 19 - src\\server.test.ts
  ---
  duration_ms: 948.3432
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\server.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: Assignment Generator Service
    # Subtest: Daily Rule Type
        # Subtest: generates assignment for each day
        not ok 1 - generates assignment for each day
          ---
          duration_ms: 14.2028
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:1:1928'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Promise.all (index 0)
          ...
        # Subtest: rotates children when children array provided
        not ok 2 - rotates children when children array provided
          ---
          duration_ms: 8.461
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:3:295'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: creates null assignment when no children
        not ok 3 - creates null assignment when no children
          ---
          duration_ms: 4.0737
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:5:316'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: skips inactive tasks
        not ok 4 - skips inactive tasks
          ---
          duration_ms: 2.5229
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:6:511'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: handles date range boundaries
        not ok 5 - handles date range boundaries
          ---
          duration_ms: 3.3628
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:7:288'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 1 - Daily Rule Type
      ---
      duration_ms: 34.3678
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:1:1896'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: Repeating Rule Type
        # Subtest: generates only on repeat_days
        not ok 1 - generates only on repeat_days
          ---
          duration_ms: 4.7428
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:8:593'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: skips non-repeat days
        not ok 2 - skips non-repeat days
          ---
          duration_ms: 3.7403
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:9:619'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: rotates children on repeat days
        not ok 3 - rotates children on repeat days
          ---
          duration_ms: 3.486
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:10:582'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: handles Sunday (0) and Saturday (6)
        not ok 4 - handles Sunday (0) and Saturday (6)
          ---
          duration_ms: 6.9387
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:11:741'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: multiple repeat days work correctly
        not ok 5 - multiple repeat days work correctly
          ---
          duration_ms: 5.346
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:12:667'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 2 - Repeating Rule Type
      ---
      duration_ms: 26.4818
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:8:557'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: Weekly Rotation - Odd/Even
        # Subtest: assigns first child on odd weeks
        not ok 1 - assigns first child on odd weeks
          ---
          duration_ms: 8.8419
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:13:709'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: assigns second child on even weeks
        not ok 2 - assigns second child on even weeks
          ---
          duration_ms: 2.845
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:14:689'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: cycles through 3+ children (modulo)
        not ok 3 - cycles through 3+ children (modulo)
          ---
          duration_ms: 3.1485
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:15:688'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: calculates ISO week correctly
        not ok 4 - calculates ISO week correctly
          ---
          duration_ms: 2.7256
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:16:533'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: handles year boundaries (week 52/53  week 1)
        not ok 5 - handles year boundaries (week 52/53  week 1)
          ---
          duration_ms: 2.9824
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:17:550'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 3 - Weekly Rotation - Odd/Even
      ---
      duration_ms: 21.5369
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:13:666'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: Weekly Rotation - Alternating
        # Subtest: rotates to next child based on last assignment
        not ok 1 - rotates to next child based on last assignment
          ---
          duration_ms: 3.633
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:18:664'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: handles first assignment (no history)
        not ok 2 - handles first assignment (no history)
          ---
          duration_ms: 3.2646
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:21:181'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: cycles back to first child after last
        not ok 3 - cycles back to first child after last
          ---
          duration_ms: 2.8295
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:22:548'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: queries correct household for history
        not ok 4 - queries correct household for history
          ---
          duration_ms: 3.6528
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:25:135'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: handles multiple tasks with separate rotations
        not ok 5 - handles multiple tasks with separate rotations
          ---
          duration_ms: 2.9046
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:28:716'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 4 - Weekly Rotation - Alternating
      ---
      duration_ms: 17.3096
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:18:618'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: Idempotency
        # Subtest: re-running same date range skips existing
        not ok 1 - re-running same date range skips existing
          ---
          duration_ms: 3.6779
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:34:171'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns correct skipped count
        not ok 2 - returns correct skipped count
          ---
          duration_ms: 3.144
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:35:581'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: no duplicate assignments created
        not ok 3 - no duplicate assignments created
          ---
          duration_ms: 3.1907
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:37:338'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: ON CONFLICT DO NOTHING works
        not ok 4 - ON CONFLICT DO NOTHING works
          ---
          duration_ms: 2.2717
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:38:489'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..4
    not ok 5 - Idempotency
      ---
      duration_ms: 13.1182
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:34:143'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: Edge Cases
        # Subtest: empty children array (null assignments)
        not ok 1 - empty children array (null assignments)
          ---
          duration_ms: 2.8943
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:39:695'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: no active tasks (no assignments)
        not ok 2 - no active tasks (no assignments)
          ---
          duration_ms: 2.0276
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:40:451'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: invalid household_id (no tasks found)
        not ok 3 - invalid household_id (no tasks found)
          ---
          duration_ms: 2.0866
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:42:245'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: 30-day generation (batch performance)
        not ok 4 - 30-day generation (batch performance)
          ---
          duration_ms: 2.8257
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:42:561'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: validation errors
        not ok 5 - validation errors
          ---
          duration_ms: 2.3962
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:43:392'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment-generator.test.ts:34:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 6 - Edge Cases
      ---
      duration_ms: 13.0186
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:39:668'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    1..6
not ok 20 - Assignment Generator Service
  ---
  duration_ms: 128.4079
  type: 'suite'
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment-generator.test.ts:1:215'
  failureType: 'subtestsFailed'
  error: '6 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: AssignmentService
    # Subtest: generateAssignments
        # Subtest: generates assignments successfully
        not ok 1 - generates assignments successfully
          ---
          duration_ms: 22.3247
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:2:755'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Promise.all (index 0)
          ...
        # Subtest: is idempotent
        not ok 2 - is idempotent
          ---
          duration_ms: 8.4029
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:2:1032'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..2
    not ok 1 - generateAssignments
      ---
      duration_ms: 32.6984
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:2:719'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: completeAssignment
        # Subtest: completes assignment and records points
        not ok 1 - completes assignment and records points
          ---
          duration_ms: 5.4499
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:3:168'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: is idempotent for already completed
        not ok 2 - is idempotent for already completed
          ---
          duration_ms: 4.4525
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:3:826'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws for non-existent assignment
        not ok 3 - throws for non-existent assignment
          ---
          duration_ms: 3.5923
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:3:1417'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 2 - completeAssignment
      ---
      duration_ms: 14.5423
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:2:1415'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getChildAssignments
        # Subtest: returns assignments for specific child
        not ok 1 - returns assignments for specific child
          ---
          duration_ms: 4.1291
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:6:110'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: respects date range
        not ok 2 - respects date range
          ---
          duration_ms: 4.7212
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:6:407'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: includes task details
        not ok 3 - includes task details
          ---
          duration_ms: 3.8554
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:6:669'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns empty array for child with no assignments
        not ok 4 - returns empty array for child with no assignments
          ---
          duration_ms: 3.601
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:6:925'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..4
    not ok 3 - getChildAssignments
      ---
      duration_ms: 17.5863
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:3:1708'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getHouseholdAssignments
        # Subtest: returns all assignments for household
        not ok 1 - returns all assignments for household
          ---
          duration_ms: 4.0869
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:9:110'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: filters by childId
        not ok 2 - filters by childId
          ---
          duration_ms: 2.8024
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:9:341'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: filters by status
        not ok 3 - filters by status
          ---
          duration_ms: 2.7886
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:9:647'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: combines filters
        not ok 4 - combines filters
          ---
          duration_ms: 3.1495
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:9:938'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..4
    not ok 4 - getHouseholdAssignments
      ---
      duration_ms: 13.6921
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:6:1361'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getAssignment
        # Subtest: returns assignment for valid ID
        not ok 1 - returns assignment for valid ID
          ---
          duration_ms: 3.6093
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:168'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns null for non-existent ID
        not ok 2 - returns null for non-existent ID
          ---
          duration_ms: 3.1247
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:486'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..2
    not ok 5 - getAssignment
      ---
      duration_ms: 7.4865
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:9:1274'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: createManualAssignment
        # Subtest: creates assignment successfully
        not ok 1 - creates assignment successfully
          ---
          duration_ms: 3.6967
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:720'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: creates household-wide assignment (null childId)
        not ok 2 - creates household-wide assignment (null childId)
          ---
          duration_ms: 2.8483
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:1125'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws for duplicate assignment
        not ok 3 - throws for duplicate assignment
          ---
          duration_ms: 2.4452
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:1379'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws for non-existent task
        not ok 4 - throws for non-existent task
          ---
          duration_ms: 2.2731
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:1765'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws for inactive task
        not ok 5 - throws for inactive task
          ---
          duration_ms: 1.9308
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:2110'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws for child from different household
        not ok 6 - throws for child from different household
          ---
          duration_ms: 2.5427
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:2468'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..6
    not ok 6 - createManualAssignment
      ---
      duration_ms: 16.6966
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:681'
      failureType: 'subtestsFailed'
      error: '6 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: reassignAssignment
        # Subtest: reassigns to different child
        not ok 1 - reassigns to different child
          ---
          duration_ms: 3.067
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:11:168'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns null for non-existent assignment
        not ok 2 - returns null for non-existent assignment
          ---
          duration_ms: 2.0368
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:11:568'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws for completed assignment
        not ok 3 - throws for completed assignment
          ---
          duration_ms: 2.8244
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:11:782'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws for child from different household
        not ok 4 - throws for child from different household
          ---
          duration_ms: 3.1706
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:11:1142'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\assignment.service.test.ts:36:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..4
    not ok 7 - reassignAssignment
      ---
      duration_ms: 11.8846
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:10:3330'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    1..7
not ok 21 - AssignmentService
  ---
  duration_ms: 117.5048
  type: 'suite'
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\assignment.service.test.ts:1:178'
  failureType: 'subtestsFailed'
  error: '7 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: AuthorizationService
    # Subtest: checkHouseholdMembership
        # Subtest: returns membership info for valid member
        not ok 1 - returns membership info for valid member
          ---
          duration_ms: 28.0995
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:1020'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Promise.all (index 0)
          ...
        # Subtest: returns null for non-member
        not ok 2 - returns null for non-member
          ---
          duration_ms: 9.8827
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:1350'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for invalid household
        not ok 3 - returns null for invalid household
          ---
          duration_ms: 4.3852
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:1836'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns correct role for parent
        not ok 4 - returns correct role for parent
          ---
          duration_ms: 5.5655
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:2106'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns correct role for child
        not ok 5 - returns correct role for child
          ---
          duration_ms: 3.6744
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:2334'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 1 - checkHouseholdMembership
      ---
      duration_ms: 53.9238
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:979'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: requireRole
        # Subtest: returns membership for allowed role
        not ok 1 - returns membership for allowed role
          ---
          duration_ms: 4.6441
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:2589'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: allows parent when parent role is specified
        not ok 2 - allows parent when parent role is specified
          ---
          duration_ms: 3.3249
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:2815'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws NOT_MEMBER for non-member
        not ok 3 - throws NOT_MEMBER for non-member
          ---
          duration_ms: 4.2573
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:3056'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws INSUFFICIENT_ROLE for wrong role
        not ok 4 - throws INSUFFICIENT_ROLE for wrong role
          ---
          duration_ms: 16.7159
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:3642'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: allows child when child role is specified
        not ok 5 - allows child when child role is specified
          ---
          duration_ms: 3.8441
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:4014'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 2 - requireRole
      ---
      duration_ms: 34.4041
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:2561'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: canModifyTask
        # Subtest: returns true for admin
        not ok 1 - returns true for admin
          ---
          duration_ms: 26.007
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:4274'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns true for parent
        not ok 2 - returns true for parent
          ---
          duration_ms: 4.3799
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:4450'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for child
        not ok 3 - returns false for child
          ---
          duration_ms: 4.2807
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:4634'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for non-member
        not ok 4 - returns false for non-member
          ---
          duration_ms: 3.4259
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:4821'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for non-existent task
        not ok 5 - returns false for non-existent task
          ---
          duration_ms: 3.1331
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:5304'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 3 - canModifyTask
      ---
      duration_ms: 43.4126
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:4244'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: canCompleteAssignment
        # Subtest: returns true for admin
        not ok 1 - returns true for admin
          ---
          duration_ms: 4.3727
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:5596'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns true for parent
        not ok 2 - returns true for parent
          ---
          duration_ms: 5.6149
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:5794'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns true for assigned child
        not ok 3 - returns true for assigned child
          ---
          duration_ms: 2.3976
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:6000'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for different child
        not ok 4 - returns false for different child
          ---
          duration_ms: 2.3258
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:6221'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for household-wide task completion by child
        not ok 5 - returns false for household-wide task completion by child
          ---
          duration_ms: 2.5683
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:7234'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for non-member
        not ok 6 - returns false for non-member
          ---
          duration_ms: 3.9021
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:454'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for non-existent assignment
        not ok 7 - returns false for non-existent assignment
          ---
          duration_ms: 12.7231
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:959'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..7
    not ok 4 - canCompleteAssignment
      ---
      duration_ms: 35.442
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:7:5558'
      failureType: 'subtestsFailed'
      error: '7 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getLinkedChildId
        # Subtest: returns child ID for user with linked child
        not ok 1 - returns child ID for user with linked child
          ---
          duration_ms: 4.6815
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:1278'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for user without linked child
        not ok 2 - returns null for user without linked child
          ---
          duration_ms: 8.0962
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:1489'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for non-existent user
        not ok 3 - returns null for non-existent user
          ---
          duration_ms: 5.8419
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:1706'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 5 - getLinkedChildId
      ---
      duration_ms: 19.937
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:1245'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: childBelongsToHousehold
        # Subtest: returns true for child in household
        not ok 1 - returns true for child in household
          ---
          duration_ms: 3.5915
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:2005'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for child in different household
        not ok 2 - returns false for child in different household
          ---
          duration_ms: 3.7544
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:2207'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for non-existent child
        not ok 3 - returns false for non-existent child
          ---
          duration_ms: 3.7044
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:2698'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 6 - childBelongsToHousehold
      ---
      duration_ms: 12.0122
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:1965'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: taskBelongsToHousehold
        # Subtest: returns true for task in household
        not ok 1 - returns true for task in household
          ---
          duration_ms: 10.0384
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:3010'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for task in different household
        not ok 2 - returns false for task in different household
          ---
          duration_ms: 4.1942
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:3208'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for non-existent task
        not ok 3 - returns false for non-existent task
          ---
          duration_ms: 6.2668
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:3695'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 7 - taskBelongsToHousehold
      ---
      duration_ms: 21.4182
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:2971'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getTaskHouseholdId
        # Subtest: returns household ID for existing task
        not ok 1 - returns household ID for existing task
          ---
          duration_ms: 3.4122
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:3998'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for non-existent task
        not ok 2 - returns null for non-existent task
          ---
          duration_ms: 5.2611
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:4194'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..2
    not ok 8 - getTaskHouseholdId
      ---
      duration_ms: 10.2229
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:3963'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getAssignmentHouseholdId
        # Subtest: returns household ID for existing assignment
        not ok 1 - returns household ID for existing assignment
          ---
          duration_ms: 4.2084
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:4480'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for non-existent assignment
        not ok 2 - returns null for non-existent assignment
          ---
          duration_ms: 3.2787
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:4694'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..2
    not ok 9 - getAssignmentHouseholdId
      ---
      duration_ms: 8.2879
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:4439'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: isAuthorizationError
        # Subtest: returns true for valid AuthorizationError
        not ok 1 - returns true for valid AuthorizationError
          ---
          duration_ms: 4.4102
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:5006'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for non-object
        not ok 2 - returns false for non-object
          ---
          duration_ms: 3.1292
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:5170'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for object without code
        not ok 3 - returns false for object without code
          ---
          duration_ms: 3.7412
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:5430'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for object without message
        not ok 4 - returns false for object without message
          ---
          duration_ms: 3.9787
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:5573'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\authorization.service.test.ts:43:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..4
    not ok 10 - isAuthorizationError
      ---
      duration_ms: 16.3253
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:8:4969'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    1..10
not ok 22 - AuthorizationService
  ---
  duration_ms: 260.0463
  type: 'suite'
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\authorization.service.test.ts:1:205'
  failureType: 'subtestsFailed'
  error: '10 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: HouseholdService
    # Subtest: createHousehold
        # Subtest: creates household with creator as admin
        not ok 1 - creates household with creator as admin
          ---
          duration_ms: 48.5348
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:803'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Promise.all (index 0)
          ...
        # Subtest: trims whitespace from name
        not ok 2 - trims whitespace from name
          ---
          duration_ms: 16.8961
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:1201'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: creates household_members record
        not ok 3 - creates household_members record
          ---
          duration_ms: 6.9871
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:1401'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 1 - createHousehold
      ---
      duration_ms: 74.1161
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:771'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: getHousehold
        # Subtest: returns household for valid ID
        not ok 1 - returns household for valid ID
          ---
          duration_ms: 7.3131
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:2049'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns null for non-existent ID
        not ok 2 - returns null for non-existent ID
          ---
          duration_ms: 3.9906
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:2311'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..2
    not ok 2 - getHousehold
      ---
      duration_ms: 12.3094
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:1852'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getHouseholdWithCounts
        # Subtest: returns household with correct counts
        not ok 1 - returns household with correct counts
          ---
          duration_ms: 4.1352
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:3264'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns null for non-existent ID
        not ok 2 - returns null for non-existent ID
          ---
          duration_ms: 4.2149
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:3577'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..2
    not ok 3 - getHouseholdWithCounts
      ---
      duration_ms: 9.8548
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:2524'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: updateHousehold
        # Subtest: updates household name
        not ok 1 - updates household name
          ---
          duration_ms: 5.8629
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:3995'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: trims whitespace from name
        not ok 2 - trims whitespace from name
          ---
          duration_ms: 6.7124
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:4203'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for non-existent ID
        not ok 3 - returns null for non-existent ID
          ---
          duration_ms: 3.499
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:4417'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 4 - updateHousehold
      ---
      duration_ms: 17.5491
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:3800'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: addMember
        # Subtest: adds member with specified role
        not ok 1 - adds member with specified role
          ---
          duration_ms: 3.4258
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:4829'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: throws error for duplicate member
        not ok 2 - throws error for duplicate member
          ---
          duration_ms: 3.7761
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:5187'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..2
    not ok 5 - addMember
      ---
      duration_ms: 10.1807
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:4638'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: removeMember
        # Subtest: removes non-admin member
        not ok 1 - removes non-admin member
          ---
          duration_ms: 5.1283
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:5985'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns false for non-existent member
        not ok 2 - returns false for non-existent member
          ---
          duration_ms: 3.9948
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:6390'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws error when removing last admin
        not ok 3 - throws error when removing last admin
          ---
          duration_ms: 2.4378
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:6626'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: allows removing admin when another admin exists
        not ok 4 - allows removing admin when another admin exists
          ---
          duration_ms: 7.0868
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:6881'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..4
    not ok 6 - removeMember
      ---
      duration_ms: 19.9101
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:5512'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getHouseholdMembers
        # Subtest: returns all members with correct data
        not ok 1 - returns all members with correct data
          ---
          duration_ms: 4.3629
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:8068'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns empty array for household with no members
        not ok 2 - returns empty array for household with no members
          ---
          duration_ms: 15.2225
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:8493'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..2
    not ok 7 - getHouseholdMembers
      ---
      duration_ms: 20.2959
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:7590'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: listUserHouseholds
        # Subtest: returns all households for user
        not ok 1 - returns all households for user
          ---
          duration_ms: 12.887
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:10121'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: includes role and counts
        not ok 2 - includes role and counts
          ---
          duration_ms: 5.626
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:10303'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns empty array for user with no households
        not ok 3 - returns empty array for user with no households
          ---
          duration_ms: 6.09
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:10623'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 8 - listUserHouseholds
      ---
      duration_ms: 25.5093
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:8961'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: updateMemberRole
        # Subtest: updates member role
        not ok 1 - updates member role
          ---
          duration_ms: 3.1452
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:11576'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns false for non-existent member
        not ok 2 - returns false for non-existent member
          ---
          duration_ms: 2.2978
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:11970'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws error when demoting last admin
        not ok 3 - throws error when demoting last admin
          ---
          duration_ms: 2.2571
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:12219'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: allows demoting admin when another admin exists
        not ok 4 - allows demoting admin when another admin exists
          ---
          duration_ms: 3.2476
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:12487'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..4
    not ok 9 - updateMemberRole
      ---
      duration_ms: 12.1933
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:11101'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getMemberRole
        # Subtest: returns role for existing member
        not ok 1 - returns role for existing member
          ---
          duration_ms: 5.4966
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:13117'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns null for non-member
        not ok 2 - returns null for non-member
          ---
          duration_ms: 3.6264
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:13269'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for non-existent household
        not ok 3 - returns null for non-existent household
          ---
          duration_ms: 5.9105
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:13414'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\household.service.test.ts:36:25)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 10 - getMemberRole
      ---
      duration_ms: 16.2775
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:3:12787'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    1..10
not ok 23 - HouseholdService
  ---
  duration_ms: 224.0566
  type: 'suite'
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\household.service.test.ts:1:176'
  failureType: 'subtestsFailed'
  error: '10 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: TaskService
    # Subtest: validateTaskRules
        # Subtest: validates daily task with no errors
        not ok 1 - validates daily task with no errors
          ---
          duration_ms: 36.5546
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:1743'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Promise.all (index 0)
          ...
        # Subtest: validates weekly_rotation requires rotationType
        not ok 2 - validates weekly_rotation requires rotationType
          ---
          duration_ms: 9.6418
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:1982'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: validates weekly_rotation with valid rotationType
        not ok 3 - validates weekly_rotation with valid rotationType
          ---
          duration_ms: 4.4195
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:2298'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: validates weekly_rotation with invalid rotationType
        not ok 4 - validates weekly_rotation with invalid rotationType
          ---
          duration_ms: 8.7103
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:2581'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: validates repeating requires repeatDays
        not ok 5 - validates repeating requires repeatDays
          ---
          duration_ms: 3.9016
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:2938'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: validates repeating with empty repeatDays
        not ok 6 - validates repeating with empty repeatDays
          ---
          duration_ms: 4.4936
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:3239'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: validates repeating with valid repeatDays
        not ok 7 - validates repeating with valid repeatDays
          ---
          duration_ms: 13.7765
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:3555'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: validates repeating with invalid repeatDays values
        not ok 8 - validates repeating with invalid repeatDays values
          ---
          duration_ms: 3.974
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:3815'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: handles null ruleConfig
        not ok 9 - handles null ruleConfig
          ---
          duration_ms: 4.2155
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:4162'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..9
    not ok 1 - validateTaskRules
      ---
      duration_ms: 92.4782
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:1709'
      failureType: 'subtestsFailed'
      error: '9 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: validateChildrenBelongToHousehold
        # Subtest: returns true for empty array
        not ok 1 - returns true for empty array
          ---
          duration_ms: 5.2313
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:4459'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns true for valid children
        not ok 2 - returns true for valid children
          ---
          duration_ms: 3.8381
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:4650'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for invalid children
        not ok 3 - returns false for invalid children
          ---
          duration_ms: 3.5421
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:4857'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for mixed valid and invalid children
        not ok 4 - returns false for mixed valid and invalid children
          ---
          duration_ms: 3.0762
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:5127'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for children from different household
        not ok 5 - returns false for children from different household
          ---
          duration_ms: 2.8888
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:5435'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..5
    not ok 2 - validateChildrenBelongToHousehold
      ---
      duration_ms: 19.8026
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:4409'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: createTask
        # Subtest: creates daily task successfully
        not ok 1 - creates daily task successfully
          ---
          duration_ms: 5.9005
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:6273'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: creates task with default points
        not ok 2 - creates task with default points
          ---
          duration_ms: 4.1421
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:6923'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: trims whitespace from name
        not ok 3 - trims whitespace from name
          ---
          duration_ms: 5.2642
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:7155'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws validation error for invalid weekly_rotation
        not ok 4 - throws validation error for invalid weekly_rotation
          ---
          duration_ms: 2.4712
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:7358'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws error for invalid children
        not ok 5 - throws error for invalid children
          ---
          duration_ms: 2.0725
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:7737'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: creates weekly_rotation task with valid config
        not ok 6 - creates weekly_rotation task with valid config
          ---
          duration_ms: 2.0431
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:8161'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: creates repeating task with valid config
        not ok 7 - creates repeating task with valid config
          ---
          duration_ms: 4.159
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:8543'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..7
    not ok 3 - createTask
      ---
      duration_ms: 27.2617
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:6246'
      failureType: 'subtestsFailed'
      error: '7 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: updateTask
        # Subtest: updates task name
        not ok 1 - updates task name
          ---
          duration_ms: 3.8355
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:174'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: updates task description
        not ok 2 - updates task description
          ---
          duration_ms: 2.7607
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:397'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: updates task points
        not ok 3 - updates task points
          ---
          duration_ms: 3.1496
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:647'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: updates task active status
        not ok 4 - updates task active status
          ---
          duration_ms: 4.6157
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:852'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for non-existent task
        not ok 5 - returns null for non-existent task
          ---
          duration_ms: 2.977
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:1070'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for task in different household
        not ok 6 - returns null for task in different household
          ---
          duration_ms: 5.5427
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:1338'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: throws error for empty update
        not ok 7 - throws error for empty update
          ---
          duration_ms: 5.6628
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:1841'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: validates rule config when changing rule type
        not ok 8 - validates rule config when changing rule type
          ---
          duration_ms: 7.1152
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:2102'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..8
    not ok 4 - updateTask
      ---
      duration_ms: 37.6351
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:8887'
      failureType: 'subtestsFailed'
      error: '8 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: deactivateTask
        # Subtest: deactivates task successfully
        not ok 1 - deactivates task successfully
          ---
          duration_ms: 10.567
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:3:129'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns false for non-existent task
        not ok 2 - returns false for non-existent task
          ---
          duration_ms: 17.5324
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:3:512'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for task in different household
        not ok 3 - returns false for task in different household
          ---
          duration_ms: 9.4327
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:3:770'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 5 - deactivateTask
      ---
      duration_ms: 38.4849
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:2:2400'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getTask
        # Subtest: returns task for valid ID and household
        not ok 1 - returns task for valid ID and household
          ---
          duration_ms: 2.6119
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:4:183'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: returns null for non-existent task
        not ok 2 - returns null for non-existent task
          ---
          duration_ms: 2.1618
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:4:515'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns null for task in different household
        not ok 3 - returns null for task in different household
          ---
          duration_ms: 2.2082
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:4:759'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 6 - getTask
      ---
      duration_ms: 7.58
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:3:1265'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: listTasks
        # Subtest: lists all tasks
        not ok 1 - lists all tasks
          ---
          duration_ms: 2.7376
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:86'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
          ...
        # Subtest: filters by active status
        not ok 2 - filters by active status
          ---
          duration_ms: 2.3022
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:296'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: paginates results
        not ok 3 - paginates results
          ---
          duration_ms: 5.9767
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:754'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: sorts by name ascending
        not ok 4 - sorts by name ascending
          ---
          duration_ms: 4.2219
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:1078'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: sorts by points descending
        not ok 5 - sorts by points descending
          ---
          duration_ms: 2.9934
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:1336'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns empty array for household with no tasks
        not ok 6 - returns empty array for household with no tasks
          ---
          duration_ms: 2.8465
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:1588'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async node:internal/test_runner/test:852:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..6
    not ok 7 - listTasks
      ---
      duration_ms: 22.0997
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:4:1240'
      failureType: 'subtestsFailed'
      error: '6 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: hasValidationErrors
        # Subtest: returns true for error with validationErrors
        not ok 1 - returns true for error with validationErrors
          ---
          duration_ms: 3.3862
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:2139'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1320:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for regular Error
        not ok 2 - returns false for regular Error
          ---
          duration_ms: 6.7108
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:2352'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        # Subtest: returns false for non-Error
        not ok 3 - returns false for non-Error
          ---
          duration_ms: 4.1932
          location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:2490'
          failureType: 'hookFailed'
          error: 'connect ECONNREFUSED ::1:55432'
          code: 'ECONNREFUSED'
          stack: |-
            C:\code\st44-home\node_modules\pg-pool\index.js:45:11
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async TestContext.<anonymous> (C:\code\st44-home\apps\backend\src\services\task.service.test.ts:40:29)
            async TestHook.run (node:internal/test_runner/test:935:9)
            async node:internal/test_runner/test:853:9
            async Suite.runHook (node:internal/test_runner/test:851:7)
            async Test.run (node:internal/test_runner/test:910:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:633:7)
          ...
        1..3
    not ok 8 - hasValidationErrors
      ---
      duration_ms: 16.3461
      type: 'suite'
      location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:7:2103'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    1..8
not ok 24 - TaskService
  ---
  duration_ms: 264.9409
  type: 'suite'
  location: 'C:\\code\\st44-home\\apps\\backend\\src\\services\\task.service.test.ts:1:186'
  failureType: 'subtestsFailed'
  error: '8 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: JWT Utilities
    # Subtest: generateAccessToken
        # Subtest: should generate a valid JWT string
        ok 1 - should generate a valid JWT string
          ---
          duration_ms: 4.748
          ...
        # Subtest: should include user data in payload
        ok 2 - should include user data in payload
          ---
          duration_ms: 2.6459
          ...
        # Subtest: should use default secret when not provided
        ok 3 - should use default secret when not provided
          ---
          duration_ms: 1.3686
          ...
        # Subtest: should generate different tokens for different users
        ok 4 - should generate different tokens for different users
          ---
          duration_ms: 2.6138
          ...
        # Subtest: should include firstName and lastName in payload
        ok 5 - should include firstName and lastName in payload
          ---
          duration_ms: 2.3911
          ...
        1..5
    ok 1 - generateAccessToken
      ---
      duration_ms: 15.2775
      type: 'suite'
      ...
    # Subtest: generateRefreshToken
        # Subtest: should generate a valid JWT string
        ok 1 - should generate a valid JWT string
          ---
          duration_ms: 2.7388
          ...
        # Subtest: should include user id and type in payload
        ok 2 - should include user id and type in payload
          ---
          duration_ms: 1.6843
          ...
        # Subtest: should NOT include email in refresh token
        ok 3 - should NOT include email in refresh token
          ---
          duration_ms: 9.4901
          ...
        1..3
    ok 2 - generateRefreshToken
      ---
      duration_ms: 17.4491
      type: 'suite'
      ...
    # Subtest: verifyAccessToken
        # Subtest: should verify valid access token
        ok 1 - should verify valid access token
          ---
          duration_ms: 6.6742
          ...
        # Subtest: should reject invalid token
        ok 2 - should reject invalid token
          ---
          duration_ms: 0.7721
          ...
        # Subtest: should reject token with wrong secret
        ok 3 - should reject token with wrong secret
          ---
          duration_ms: 2.4885
          ...
        # Subtest: should reject refresh token as access token
        ok 4 - should reject refresh token as access token
          ---
          duration_ms: 2.4833
          ...
        # Subtest: should reject expired token
        ok 5 - should reject expired token
          ---
          duration_ms: 17.7602
          ...
        # Subtest: should reject malformed token
        ok 6 - should reject malformed token
          ---
          duration_ms: 0.3893
          ...
        # Subtest: should reject empty token
        ok 7 - should reject empty token
          ---
          duration_ms: 0.3109
          ...
        1..7
    ok 3 - verifyAccessToken
      ---
      duration_ms: 31.5875
      type: 'suite'
      ...
    # Subtest: verifyRefreshToken
        # Subtest: should verify valid refresh token
        ok 1 - should verify valid refresh token
          ---
          duration_ms: 2.5923
          ...
        # Subtest: should reject access token as refresh token
        ok 2 - should reject access token as refresh token
          ---
          duration_ms: 2.2022
          ...
        # Subtest: should reject invalid token
        ok 3 - should reject invalid token
          ---
          duration_ms: 0.4478
          ...
        # Subtest: should reject token with wrong secret
        ok 4 - should reject token with wrong secret
          ---
          duration_ms: 2.2714
          ...
        1..4
    ok 4 - verifyRefreshToken
      ---
      duration_ms: 7.9406
      type: 'suite'
      ...
    # Subtest: decodeToken
        # Subtest: should decode token without verification
        ok 1 - should decode token without verification
          ---
          duration_ms: 1.3212
          ...
        # Subtest: should decode token even with wrong secret
        ok 2 - should decode token even with wrong secret
          ---
          duration_ms: 1.2265
          ...
        # Subtest: should return null for invalid token
        ok 3 - should return null for invalid token
          ---
          duration_ms: 0.2254
          ...
        1..3
    ok 5 - decodeToken
      ---
      duration_ms: 3.1795
      type: 'suite'
      ...
    # Subtest: isTokenExpired
        # Subtest: should return false for valid non-expired token
        ok 1 - should return false for valid non-expired token
          ---
          duration_ms: 1.3967
          ...
        # Subtest: should return true for expired token
        ok 2 - should return true for expired token
          ---
          duration_ms: 11.1826
          ...
        # Subtest: should return true for invalid token
        ok 3 - should return true for invalid token
          ---
          duration_ms: 0.3059
          ...
        # Subtest: should return true for token without exp claim
        ok 4 - should return true for token without exp claim
          ---
          duration_ms: 0.2278
          ...
        1..4
    ok 6 - isTokenExpired
      ---
      duration_ms: 13.4388
      type: 'suite'
      ...
    # Subtest: getJwtSecret
        # Subtest: should return a string
        ok 1 - should return a string
          ---
          duration_ms: 0.1594
          ...
        1..1
    ok 7 - getJwtSecret
      ---
      duration_ms: 0.267
      type: 'suite'
      ...
    1..7
ok 25 - JWT Utilities
  ---
  duration_ms: 90.8232
  type: 'suite'
  ...
# Subtest: Password Validation
    # Subtest: validatePasswordStrength
        # Subtest: should return true for valid password
        ok 1 - should return true for valid password
          ---
          duration_ms: 1.6918
          ...
        # Subtest: should return false for password without uppercase
        ok 2 - should return false for password without uppercase
          ---
          duration_ms: 0.4849
          ...
        # Subtest: should return false for password without lowercase
        ok 3 - should return false for password without lowercase
          ---
          duration_ms: 0.5758
          ...
        # Subtest: should return false for password without number
        ok 4 - should return false for password without number
          ---
          duration_ms: 0.898
          ...
        # Subtest: should return false for password too short
        ok 5 - should return false for password too short
          ---
          duration_ms: 0.3303
          ...
        # Subtest: should return false for empty password
        ok 6 - should return false for empty password
          ---
          duration_ms: 0.1922
          ...
        # Subtest: should return false for null/undefined
        ok 7 - should return false for null/undefined
          ---
          duration_ms: 0.2272
          ...
        # Subtest: should return false for non-string input
        ok 8 - should return false for non-string input
          ---
          duration_ms: 0.2436
          ...
        # Subtest: should accept password with exactly 8 characters
        ok 9 - should accept password with exactly 8 characters
          ---
          duration_ms: 0.3675
          ...
        # Subtest: should accept very long passwords
        ok 10 - should accept very long passwords
          ---
          duration_ms: 0.4895
          ...
        1..10
    ok 1 - validatePasswordStrength
      ---
      duration_ms: 8.4163
      type: 'suite'
      ...
    # Subtest: validatePasswordWithDetails
        # Subtest: should return valid for good password
        ok 1 - should return valid for good password
          ---
          duration_ms: 0.4603
          ...
        # Subtest: should return error for missing uppercase
        ok 2 - should return error for missing uppercase
          ---
          duration_ms: 0.3024
          ...
        # Subtest: should return error for missing lowercase
        ok 3 - should return error for missing lowercase
          ---
          duration_ms: 0.1956
          ...
        # Subtest: should return error for missing number
        ok 4 - should return error for missing number
          ---
          duration_ms: 0.1507
          ...
        # Subtest: should return error for too short
        ok 5 - should return error for too short
          ---
          duration_ms: 0.1533
          ...
        # Subtest: should return multiple errors for multiple violations
        ok 6 - should return multiple errors for multiple violations
          ---
          duration_ms: 0.1441
          ...
        # Subtest: should return error for empty password
        ok 7 - should return error for empty password
          ---
          duration_ms: 0.1309
          ...
        # Subtest: should return error for null password
        ok 8 - should return error for null password
          ---
          duration_ms: 0.1199
          ...
        1..8
    ok 2 - validatePasswordWithDetails
      ---
      duration_ms: 2.0487
      type: 'suite'
      ...
    # Subtest: hasWeakPatterns
        # Subtest: should detect common weak passwords
        ok 1 - should detect common weak passwords
          ---
          duration_ms: 0.5189
          ...
        # Subtest: should return false for strong passwords
        ok 2 - should return false for strong passwords
          ---
          duration_ms: 0.1805
          ...
        # Subtest: should return true for empty/null
        ok 3 - should return true for empty/null
          ---
          duration_ms: 0.1142
          ...
        # Subtest: should detect weak patterns at start only
        ok 4 - should detect weak patterns at start only
          ---
          duration_ms: 0.1604
          ...
        1..4
    ok 3 - hasWeakPatterns
      ---
      duration_ms: 1.1739
      type: 'suite'
      ...
    # Subtest: PASSWORD_RULES
        # Subtest: should have expected default values
        ok 1 - should have expected default values
          ---
          duration_ms: 0.1587
          ...
        1..1
    ok 4 - PASSWORD_RULES
      ---
      duration_ms: 0.3938
      type: 'suite'
      ...
    1..4
ok 26 - Password Validation
  ---
  duration_ms: 13.7387
  type: 'suite'
  ...
1..26
# tests 426
# suites 154
# pass 249
# fail 177
# cancelled 0
# skipped 0
# todo 0
# duration_ms 2589.3726
npm error Lifecycle script `test` failed with error:
npm error code 1
npm error path C:\code\st44-home\apps\backend
npm error workspace backend@1.0.0
npm error location C:\code\st44-home\apps\backend
npm error command failed
npm error command C:\WINDOWS\system32\cmd.exe /d /s /c cross-env NODE_ENV=test tsx --test src/**/*.test.ts
